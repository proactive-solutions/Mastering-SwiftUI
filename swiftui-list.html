<!DOCTYPE HTML>
<html lang="zh-tw" >
    
    <head>
        
        <meta charset=utf-8"UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=11; IE=10; IE=9; IE=8; IE=7; IE=EDGE" />
        <title>动态列表、 ForEach 与 Identifiable 的使用方法 | 精通 SwiftUI - iOS 16 版</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.0.1">
        <meta name="author" content="Simon Ng">
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    <link rel="next" href="./swiftui-navigation.html" />
    
    
    <link rel="prev" href="./swiftui-animation.html" />
    

        
    </head>
    <body>
        
        
    <link rel="stylesheet" href="gitbook/style.css">
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-image-captions/image-captions.css">
        
    
    
        <link rel="stylesheet" href="././styles/website.css">
    

        
    <div class="book" data-level="10" data-basepath="." data-revision="Thu Dec 01 2022 17:36:55 GMT+0800 (HKT)">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="输入并搜寻" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
            
            <li>
                <a href="https://www.appcoda.com.tw" target="blank" class="custom-link">Made by AppCoda</a>
            </li>
        
            
            <li>
                <a href="https://www.appcoda.com.tw/contact" target="blank" class="custom-link">Contact us / Support</a>
            </li>
        
            
            <li>
                <a href="http://twitter.com/share?text=Mastering%20SwiftUI%20via%20@appcodamobile&amp;url=https://www.appcoda.com.tw/swiftui/&amp;hashtags=swiftlang" target="blank" class="custom-link">Tweet this book</a>
            </li>
        
        

        
        <li class="divider"></li>
        

        
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="./index.html">
                        <i class="fa fa-check"></i>
                        
                        序言
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="swiftui-basics.html">
            
                
                    <a href="./swiftui-basics.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        SwiftUI 介绍
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="swiftui-text.html">
            
                
                    <a href="./swiftui-text.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        SwiftUI 入门 - 文字的处理
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3" data-path="swiftui-images.html">
            
                
                    <a href="./swiftui-images.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        图片的处理
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4" data-path="swiftui-stacks.html">
            
                
                    <a href="./swiftui-stacks.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        以堆叠布局使用者介面
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5" data-path="swiftui-scrollview.html">
            
                
                    <a href="./swiftui-scrollview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        ScrollView 与 Carousel UI 的建立
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="6" data-path="swiftui-buttons.html">
            
                
                    <a href="./swiftui-buttons.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        SwiftUI 按钮与渐层
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="7" data-path="swiftui-state.html">
            
                
                    <a href="./swiftui-state.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        状态(State)与绑定(Binding)
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="8" data-path="swiftui-path-shape.html">
            
                
                    <a href="./swiftui-path-shape.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        实现路径(Path)与形状(Shape)来画线与圆饼图
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="9" data-path="swiftui-animation.html">
            
                
                    <a href="./swiftui-animation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                        基础动画与转场
                    </a>
                
            
            
        </li>
    
        <li class="chapter active" data-level="10" data-path="swiftui-list.html">
            
                
                    <a href="./swiftui-list.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.</b>
                        
                        动态列表、 ForEach 与 Identifiable 的使用方法
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="11" data-path="swiftui-navigation.html">
            
                
                    <a href="./swiftui-navigation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.</b>
                        
                        导览UI与导览列客制化运用
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="12" data-path="swiftui-modal.html">
            
                
                    <a href="./swiftui-modal.html">
                        <i class="fa fa-check"></i>
                        
                            <b>12.</b>
                        
                        强制回应视图、浮动按钮与提示的实现
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="13" data-path="swiftui-form.html">
            
                
                    <a href="./swiftui-form.html">
                        <i class="fa fa-check"></i>
                        
                            <b>13.</b>
                        
                        以选取器(Picker)、开关(Toggle)与步进器(Stepper)来建立一个表单
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="14" data-path="swiftui-form-data.html">
            
                
                    <a href="./swiftui-form-data.html">
                        <i class="fa fa-check"></i>
                        
                            <b>14.</b>
                        
                        使用 Combine 与 Environment 物件进行资料分享
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="15" data-path="swiftui-form-registration.html">
            
                
                    <a href="./swiftui-form-registration.html">
                        <i class="fa fa-check"></i>
                        
                            <b>15.</b>
                        
                        以 Combine 与 视图模型建立一个注册表单
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="16" data-path="swiftui-actionsheet-context.html">
            
                
                    <a href="./swiftui-actionsheet-context.html">
                        <i class="fa fa-check"></i>
                        
                            <b>16.</b>
                        
                        滑动删除、内容选单与动作列表
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="17" data-path="swiftui-gestures.html">
            
                
                    <a href="./swiftui-gestures.html">
                        <i class="fa fa-check"></i>
                        
                            <b>17.</b>
                        
                        认识手势（Gestures）
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="18" data-path="swiftui-bottom-sheet.html">
            
                
                    <a href="./swiftui-bottom-sheet.html">
                        <i class="fa fa-check"></i>
                        
                            <b>18.</b>
                        
                        以SwiftUI 手势与 GeometryReader 建立一个底部展开式页面
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="19" data-path="swiftui-trip-tinder.html">
            
                
                    <a href="./swiftui-trip-tinder.html">
                        <i class="fa fa-check"></i>
                        
                            <b>19.</b>
                        
                        使用手势与动画建立 Tinder 风格的 UI
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="20" data-path="swiftui-advanced-animations.html">
            
                
                    <a href="./swiftui-advanced-animations.html">
                        <i class="fa fa-check"></i>
                        
                            <b>20.</b>
                        
                        建立像 Apple Wallet App 的动画和转场效果
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="21" data-path="swiftui-json.html">
            
                
                    <a href="./swiftui-json.html">
                        <i class="fa fa-check"></i>
                        
                            <b>21.</b>
                        
                        JSON、滑杆的运用与资料过滤
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="22" data-path="swiftui-core-data.html">
            
                
                    <a href="./swiftui-core-data.html">
                        <i class="fa fa-check"></i>
                        
                            <b>22.</b>
                        
                        如何使用 Core Data 建立 ToDo App
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="23" data-path="swiftui-uikit.html">
            
                
                    <a href="./swiftui-uikit.html">
                        <i class="fa fa-check"></i>
                        
                            <b>23.</b>
                        
                        利用 UIViewRepresentable 整合UIKit 组件
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="24" data-path="swiftui-searchbar.html">
            
                
                    <a href="./swiftui-searchbar.html">
                        <i class="fa fa-check"></i>
                        
                            <b>24.</b>
                        
                        建立搜寻栏视图并使用自订绑定（Custom Binding）
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="25" data-path="swiftui-real-world-app.html">
            
                
                    <a href="./swiftui-real-world-app.html">
                        <i class="fa fa-check"></i>
                        
                            <b>25.</b>
                        
                        把所学应用出来！构建个人理财App
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="26" data-path="swiftui-appstoreanimation.html">
            
                
                    <a href="./swiftui-appstoreanimation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>26.</b>
                        
                        创建类似App Store使用的动画视图转换
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="27" data-path="swiftui-carousel.html">
            
                
                    <a href="./swiftui-carousel.html">
                        <i class="fa fa-check"></i>
                        
                            <b>27.</b>
                        
                        如何建立图像轮播（Image Carousel）
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="28" data-path="swiftui-expandable-list.html">
            
                
                    <a href="./swiftui-expandable-list.html">
                        <i class="fa fa-check"></i>
                        
                            <b>28.</b>
                        
                        如何建立展开式列表视图和大纲视图
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="29" data-path="swiftui-gridlayout.html">
            
                
                    <a href="./swiftui-gridlayout.html">
                        <i class="fa fa-check"></i>
                        
                            <b>29.</b>
                        
                        使用 LazyVGrid 和 LazyHGrid 构建集合视图
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="30" data-path="swiftui-progress-ring.html">
            
                
                    <a href="./swiftui-progress-ring.html">
                        <i class="fa fa-check"></i>
                        
                            <b>30.</b>
                        
                        使用 Shape 和 Animatable 开发带动画的环形进度条
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="31" data-path="swiftui-library.html">
            
                
                    <a href="./swiftui-library.html">
                        <i class="fa fa-check"></i>
                        
                            <b>31.</b>
                        
                        如何使用 AnimatableModifier 和 LibraryContentProvider
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="32" data-path="swiftui-texteditor.html">
            
                
                    <a href="./swiftui-texteditor.html">
                        <i class="fa fa-check"></i>
                        
                            <b>32.</b>
                        
                        使用 TextEditor 支持多行文字输入
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="33" data-path="swiftui-matchedgeometry.html">
            
                
                    <a href="./swiftui-matchedgeometry.html">
                        <i class="fa fa-check"></i>
                        
                            <b>33.</b>
                        
                        使用 matchedGeometryEffect为 App 建立绚丽的视图动画
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="34" data-path="swiftui-grid-animation.html">
            
                
                    <a href="./swiftui-grid-animation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>34.</b>
                        
                        ScrollViewReader 和网格动画
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="35" data-path="swiftui-tabview.html">
            
                
                    <a href="./swiftui-tabview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>35.</b>
                        
                        标签视图的运用与自订标签列
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="36" data-path="swiftui-asyncimage.html">
            
                
                    <a href="./swiftui-asyncimage.html">
                        <i class="fa fa-check"></i>
                        
                            <b>36.</b>
                        
                        利用 AsyncImage 非同步加载和显示图像
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="37" data-path="swiftui-searchable.html">
            
                
                    <a href="./swiftui-searchable.html">
                        <i class="fa fa-check"></i>
                        
                            <b>37.</b>
                        
                        利用 Searchable 建立搜寻栏
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="38" data-path="swiftui-charts.html">
            
                
                    <a href="./swiftui-charts.html">
                        <i class="fa fa-check"></i>
                        
                            <b>38.</b>
                        
                        利用 Charts 框架建立图表
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="39" data-path="swiftui-live-text.html">
            
                
                    <a href="./swiftui-live-text.html">
                        <i class="fa fa-check"></i>
                        
                            <b>39.</b>
                        
                        利用 Live Text API 从图片中撷取文本
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="40" data-path="swiftui-sharelink.html">
            
                
                    <a href="./swiftui-sharelink.html">
                        <i class="fa fa-check"></i>
                        
                            <b>40.</b>
                        
                        透过 ShareLink 来分享文本和图像等资料
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="41" data-path="swiftui-imagerenderer.html">
            
                
                    <a href="./swiftui-imagerenderer.html">
                        <i class="fa fa-check"></i>
                        
                            <b>41.</b>
                        
                        利用 ImageRenderer API 轻松把 SwiftUI 视图转换为图像
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="42" data-path="swiftui-pdf-doc.html">
            
                
                    <a href="./swiftui-pdf-doc.html">
                        <i class="fa fa-check"></i>
                        
                            <b>42.</b>
                        
                        如何把 SwiftUI 视图转换为 PDF 文件
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="43" data-path="swiftui-gauge.html">
            
                
                    <a href="./swiftui-gauge.html">
                        <i class="fa fa-check"></i>
                        
                            <b>43.</b>
                        
                        使用 Gauge 视图显示进度并创建速度计
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="44" data-path="swiftui-grid.html">
            
                
                    <a href="./swiftui-grid.html">
                        <i class="fa fa-check"></i>
                        
                            <b>44.</b>
                        
                        使用Grid API 创建网格布局
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="45" data-path="swiftui-anylayout.html">
            
                
                    <a href="./swiftui-anylayout.html">
                        <i class="fa fa-check"></i>
                        
                            <b>45.</b>
                        
                        利用 AnyLayout 切换 UI 布局
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="46" data-path="swiftui-navigationstack.html">
            
                
                    <a href="./swiftui-navigationstack.html">
                        <i class="fa fa-check"></i>
                        
                            <b>46.</b>
                        
                        使用新的 NavigationStack 视图构建资料导向的导航
                    </a>
                
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                本书使用 GitBook 释出
            </a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="目录"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="搜寻"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="字型设定"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">衬线体</button>
        <button type="button" data-font="1" class="button">无衬线体</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">白色</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">棕褐色</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">夜间</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="分享"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    分享到 Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    分享到 Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    分享到 Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    分享到 Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    分享到 Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="./" >精通 SwiftUI - iOS 16 版</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="%E7%AC%AC-10-%E7%AB%A0-br-%E5%8B%95%E6%85%8B%E6%B8%85%E5%96%AE%E3%80%81foreach-%E8%88%87%E8%AD%98%E5%88%A5">第 10 章<br>动态清单、ForEach 与识别</h1>
<p>在 UIKit 中，表格视图是 iOS 中最常见的 UI 控制元件之一。如果你之前使用过 UIKit 开发 App，则你应该知道可使用表格视图显示资料清单。这个 UI 控制元件在以内容为主的App 很常见，例如：报纸 App。图 10.1 展示了一些清单 / 表格视图，你可在诸如 Instagram、Twitter、Airbnb 与 Apple News 等流行应用程式中找到这些视图。</p>
<figure id="fig10.1"><img src="images/list/swiftui-list-1.jpg" alt="图 10.1.　清单视图范例"><figcaption>图 10.1.　清单视图范例</figcaption></figure>
<p>在 SwiftUI 中，我们使用 <code>List</code> 代替表格视图来显示资料列。如果你之前使用过 <code>UIKit</code> 建立表格视图，你应该知道实现一个简单的表格视图，就需要花一点工夫。而若是要建立自订 Cell 布局的表格视图，则要做的工作更多。SwiftUI 简化了整个过程，只需几行代码，你就能以表格形式来陈列资料。即使你需要自订列的布局，也只需要极少的工夫即可办到。</p>
<p>仍是觉得困惑吗？待会你就能明白我的意思。</p>
<p>在本章中，我们将从一个简单的清单来开始。当你了解这些基础知识，我将教你如何以更复杂的布局来陈列资料清单，如图 10.2 所示。</p>
<figure id="fig10.2"><img src="images/list/swiftui-list-2.jpg" alt="图 10.2.　建立一个简单且多样化的清单"><figcaption>图 10.2.　建立一个简单且多样化的清单</figcaption></figure>
<h3 id="%E5%BB%BA%E7%AB%8B%E4%B8%80%E5%80%8B%E7%B0%A1%E5%96%AE%E7%9A%84%E6%B8%85%E5%96%AE">建立一个简单的清单</h3>
<p>我们从简单的清单来开始。首先，开启 Xcode，并使用“App”模板建立一个新专案。在下一个画面中，设定专案名称为“SwiftUIList”（或你喜欢的任何名称），并填入所有必填的值，只需确保在“Interface”选项中选取“SwiftUI”。</p>
<p>Xcode 应会在 <code>ContentView.swift</code> 档中产生一些代码。现在更新代码如下： </p>
<pre><code class="lang-swift"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ContentView</span>: <span class="hljs-title">View</span> </span>{
    <span class="hljs-keyword">var</span> body: some <span class="hljs-type">View</span> {
        <span class="hljs-type">List</span> {
            <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;Item 1&quot;</span>)
            <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;Item 2&quot;</span>)
            <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;Item 3&quot;</span>)
            <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;Item 4&quot;</span>)
        }
    }
}
</code></pre>
<p>以上是建立一个简单的清单或表格所需要的代码。当你将文字视图嵌入 <code>List</code> 中时，清单视图会以列显示资料。这里，每一列显示具不同叙述的文字视图。</p>
<figure id="fig10.3"><img src="images/list/swiftui-list-3.png" alt="图 10.3.　建立一个简单的清单"><figcaption>图 10.3.　建立一个简单的清单</figcaption></figure>
<p>相同的代码片段可以使用 <code>ForEach</code> 来编写，如下所示： </p>
<pre><code class="lang-swift"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ContentView</span>: <span class="hljs-title">View</span> </span>{
    <span class="hljs-keyword">var</span> body: some <span class="hljs-type">View</span> {
        <span class="hljs-type">List</span> {
            <span class="hljs-type">ForEach</span>(<span class="hljs-number">1</span>...<span class="hljs-number">4</span>, id: \.<span class="hljs-keyword">self</span>) { index <span class="hljs-keyword">in</span>
                <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;Item <span class="hljs-subst">\(index)</span>&quot;</span>)
            }
        }
    }
}
</code></pre>
<p>由于这些文字视图非常相似，因此你可在 SwiftUI 中使用 <code>ForEach</code> 回圈来建立视图。</p>
<blockquote>
<p>从已识别的底层集合中，依照需求计算视图的一种结构。</p>
<p>-  Apple 官方文件 (<a href="https://developer.apple.com/documentation/swiftui/foreach" target="_blank">https://developer.apple.com/documentation/swiftui/foreach</a>)</p>
</blockquote>
<p>你可以提供 <code>ForEach</code> 一组资料集合或一个范围。不过，你必须要注意的是，你需要告诉 <code>ForEach</code> 如何识别集合中的每个项目，参数 <code>id</code> 的目的在于此，为什么 <code>ForEach</code> 需要识别项目的唯一性呢？ SwiftUI 功能强大，可在部分或全部集合内的项目更改时自动更新 UI， 因此当更新或删除项目时，需要一个识别码来识别该项目。</p>
<p>在上面的代码中，我们传送给 <code>ForEach</code> 一个范围的值来逐一执行。该识别码设定为其值（即 1、2、3、4），<code>index</code> 参数储存回圈的目前值，例如：它从“1”这个值开始， <code>index</code> 参数的值则为“1”。</p>
<p>在闭包中，即是渲染视图所需的代码，这里也是我们需要建立的文字视图，其叙述将依据回圈中的 <code>index</code> 值而变化。如此，你就可以在清单中建立四个不同标题的项目。</p>
<p>我再教你一种技巧，相同的代码片段也可以进一步重写如下： </p>
<pre><code class="lang-swift"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ContentView</span>: <span class="hljs-title">View</span> </span>{
    <span class="hljs-keyword">var</span> body: some <span class="hljs-type">View</span> {
        <span class="hljs-type">List</span> {
            <span class="hljs-type">ForEach</span>(<span class="hljs-number">1</span>...<span class="hljs-number">4</span>, id: \.<span class="hljs-keyword">self</span>) {
                <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;Item <span class="hljs-subst">\($<span class="hljs-number">0</span>)</span>&quot;</span>)
            }
        }
    }
}
</code></pre>
<p>你可以省略 <code>index</code> 参数，并使用参数名称缩写 <code>$0</code>，它表示闭包的第一个参数。</p>
<p>我们进一步将代码重写得更简单些，你可将资料集合直接传送到 <code>List</code> 视图，代码如下： </p>
<pre><code class="lang-swift"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ContentView</span>: <span class="hljs-title">View</span> </span>{
    <span class="hljs-keyword">var</span> body: some <span class="hljs-type">View</span> {
        <span class="hljs-type">List</span>(<span class="hljs-number">1</span>...<span class="hljs-number">4</span>, id: \.<span class="hljs-keyword">self</span>) {
            <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;Item <span class="hljs-subst">\($<span class="hljs-number">0</span>)</span>&quot;</span>)
        }
    }
}
</code></pre>
<p>如你所见，只需两行代码，即可建立一个简单的清单 / 表格。</p>
<h3 id="%E5%BB%BA%E7%AB%8B%E5%85%B7%E6%96%87%E5%AD%97%E5%8F%8A%E5%9C%96%E7%89%87%E7%9A%84%E6%B8%85%E5%96%AE%E8%A6%96%E5%9C%96">建立具文字及图片的清单视图</h3>
<p>现在你已经知道如何建立一个简单的清单，接着我们来看如何使用更多样化的布局。在大多数的情况下，清单视图的项目皆会包含文字与图片，而你该如何实现呢？如果你知道 <code>Image</code>、<code>Text</code>、<code>VStack</code> 与 <code>HStack</code> 的用法的话，你应该对如何建立它有概念了。</p>
<p>如果你阅读过《<a href="https://www.appcoda.com.tw/swift" target="_blank">iOS App 程式开发实务心法</a>》一书，你应该非常熟悉这个范例。我们以此为例来看使用 SwiftUI 建立相同的表格有多么容易，如图 10.4 所示。</p>
<figure id="fig10.4"><img src="images/list/swiftui-list-4.png" alt="图 10.4　显示餐厅列的简单表格视图"><figcaption>图 10.4　显示餐厅列的简单表格视图</figcaption></figure>
<p>要使用 UIKit 建立表格，你需要建立一个表格视图或表格视图控制器，然后自订 Prototype Cell。另外，你还必须编写表格视图资料来源的代码，以提供资料。建立一个表格UI 需要很多的步骤，现在我们来看如何在 SwiftUI 中实现相同的表格视图。</p>
<p>首先，我们至下列网址来下载图片素材：<a href="https://www.appcoda.com/resources/swiftui/SwiftUISimpleTableImages.zip" target="_blank">https://www.appcoda.com/resources/swiftui/SwiftUISimpleTableImages.zip</a> 然后将 zip 档解压缩，并把所有图片汇入素材目录，如图 10.5 所示。</p>
<figure id="fig10.5"><img src="images/list/swiftui-list-5.png" alt="图 10.5.　汇入图片至素材目录"><figcaption>图 10.5.　汇入图片至素材目录</figcaption></figure>
<p>现在，切换到 <code>ContentView.swift</code> 来编写 UI 的代码。首先，我们在 <code>ContentView</code> 中声明两个数组，这些数组是用来储存餐厅名称与图片。下列是完整的代码： </p>
<pre><code class="lang-swift"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ContentView</span>: <span class="hljs-title">View</span> </span>{

    <span class="hljs-keyword">var</span> restaurantNames = [<span class="hljs-string">&quot;Cafe Deadend&quot;</span>, <span class="hljs-string">&quot;Homei&quot;</span>, <span class="hljs-string">&quot;Teakha&quot;</span>, <span class="hljs-string">&quot;Cafe Loisl&quot;</span>, <span class="hljs-string">&quot;Petite Oyster&quot;</span>, <span class="hljs-string">&quot;For Kee Restaurant&quot;</span>, <span class="hljs-string">&quot;Po&apos;s Atelier&quot;</span>, <span class="hljs-string">&quot;Bourke Street Bakery&quot;</span>, <span class="hljs-string">&quot;Haigh&apos;s Chocolate&quot;</span>, <span class="hljs-string">&quot;Palomino Espresso&quot;</span>, <span class="hljs-string">&quot;Upstate&quot;</span>, <span class="hljs-string">&quot;Traif&quot;</span>, <span class="hljs-string">&quot;Graham Avenue Meats And Deli&quot;</span>, <span class="hljs-string">&quot;Waffle &amp; Wolf&quot;</span>, <span class="hljs-string">&quot;Five Leaves&quot;</span>, <span class="hljs-string">&quot;Cafe Lore&quot;</span>, <span class="hljs-string">&quot;Confessional&quot;</span>, <span class="hljs-string">&quot;Barrafina&quot;</span>, <span class="hljs-string">&quot;Donostia&quot;</span>, <span class="hljs-string">&quot;Royal Oak&quot;</span>, <span class="hljs-string">&quot;CASK Pub and Kitchen&quot;</span>]

    <span class="hljs-keyword">var</span> restaurantImages = [<span class="hljs-string">&quot;cafedeadend&quot;</span>, <span class="hljs-string">&quot;homei&quot;</span>, <span class="hljs-string">&quot;teakha&quot;</span>, <span class="hljs-string">&quot;cafeloisl&quot;</span>, <span class="hljs-string">&quot;petiteoyster&quot;</span>, <span class="hljs-string">&quot;forkeerestaurant&quot;</span>, <span class="hljs-string">&quot;posatelier&quot;</span>, <span class="hljs-string">&quot;bourkestreetbakery&quot;</span>, <span class="hljs-string">&quot;haighschocolate&quot;</span>, <span class="hljs-string">&quot;palominoespresso&quot;</span>, <span class="hljs-string">&quot;upstate&quot;</span>, <span class="hljs-string">&quot;traif&quot;</span>, <span class="hljs-string">&quot;grahamavenuemeats&quot;</span>, <span class="hljs-string">&quot;wafflewolf&quot;</span>, <span class="hljs-string">&quot;fiveleaves&quot;</span>, <span class="hljs-string">&quot;cafelore&quot;</span>, <span class="hljs-string">&quot;confessional&quot;</span>, <span class="hljs-string">&quot;barrafina&quot;</span>, <span class="hljs-string">&quot;donostia&quot;</span>, <span class="hljs-string">&quot;royaloak&quot;</span>, <span class="hljs-string">&quot;caskpubkitchen&quot;</span>]

    <span class="hljs-keyword">var</span> body: some <span class="hljs-type">View</span> {
        <span class="hljs-type">List</span>(<span class="hljs-number">1</span>...<span class="hljs-number">4</span>, id: \.<span class="hljs-keyword">self</span>) {
            <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;Item <span class="hljs-subst">\($<span class="hljs-number">0</span>)</span>&quot;</span>)
        }
    }
}
</code></pre>
<p>两个数组具有相同项目数，<code>restaurantNames</code>  数组储存餐厅名称，<code>restaurantImages</code> 变量储存你刚汇入的图片名称。要建立如图 10.4 所示的清单视图，你只需要更新 <code>body</code> 变量如下： :</p>
<pre><code class="lang-swift"><span class="hljs-keyword">var</span> body: some <span class="hljs-type">View</span> {
    <span class="hljs-type">List</span>(restaurantNames.<span class="hljs-built_in">indices</span>, id: \.<span class="hljs-keyword">self</span>) { index <span class="hljs-keyword">in</span>
        <span class="hljs-type">HStack</span> {
            <span class="hljs-type">Image</span>(<span class="hljs-keyword">self</span>.restaurantImages[index])
                .resizable()
                .frame(width: <span class="hljs-number">40</span>, height: <span class="hljs-number">40</span>)
                .cornerRadius(<span class="hljs-number">5</span>)
            <span class="hljs-type">Text</span>(<span class="hljs-keyword">self</span>.restaurantNames[index])
        }
    }
}
</code></pre>
<p>我们做了一些修改，首先是 <code>List</code> 视图，我们传送餐厅名称的范围（即 <code>restaurantNames. indices</code> ），而不是一个固定的范围。例如：<code>restaurantNames</code> 数组有 21 个项目，范围是从 0 至 20。</p>
<p>在闭包中，代码会更新，以建立列的布局，我将不会深入探讨细节，因为如果你对堆叠视图已经完全了解，那么代码一看便明白了。为了更改<code>List</code> 视图的样式，我们附加了<code>listStyle</code> 修饰器并将样式设置为<code>plain</code>。</p>
<p>就是这样，使用不到 10 行的代码，我们已经建立了一个自订布局的清单（或表格）。</p>
<figure id="fig10.6"><img src="images/list/swiftui-list-6.png" alt="图 10.6.　自订列布局的清单视图"><figcaption>图 10.6.　自订列布局的清单视图</figcaption></figure>
<h4 id="%E4%BD%BF%E7%94%A8%E8%B3%87%E6%96%99%E9%9B%86%E5%90%88">使用资料集合</h4>
<p>如前所述，<code>List</code> 可以带入一个范围或一个资料集合。你已经学过如何处理范围，我们来看如何将 <code>List</code> 与餐厅资料的数组一起使用。</p>
<p>我们将建立一个 <code>Restaurant</code> 结构来加以组织资料，而不是将餐厅资料储存在两个单独的数组中。这个结构有两个属性：“name”与“image”。在 <code>ContentView.swift</code> 档的最后面， 插入下列代码： </p>
<pre><code class="lang-swift"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Restaurant</span> </span>{
    <span class="hljs-keyword">var</span> name: <span class="hljs-type">String</span>
    <span class="hljs-keyword">var</span> image: <span class="hljs-type">String</span>
}
</code></pre>
<p>使用这个结构，我们可以将 <code>restaurantNames</code> 与 <code>restaurantImages</code> 数组合并为一个数组。现在删除<code>restaurantNames</code> 与 <code>restaurantImages</code> 变量，并以 <code>ContentView</code>中的这个变量来代替： </p>
<pre><code class="lang-swift"><span class="hljs-keyword">var</span> restaurants = [ <span class="hljs-type">Restaurant</span>(name: <span class="hljs-string">&quot;Cafe Deadend&quot;</span>, image: <span class="hljs-string">&quot;cafedeadend&quot;</span>),
               <span class="hljs-type">Restaurant</span>(name: <span class="hljs-string">&quot;Homei&quot;</span>, image: <span class="hljs-string">&quot;homei&quot;</span>),
               <span class="hljs-type">Restaurant</span>(name: <span class="hljs-string">&quot;Teakha&quot;</span>, image: <span class="hljs-string">&quot;teakha&quot;</span>),
               <span class="hljs-type">Restaurant</span>(name: <span class="hljs-string">&quot;Cafe Loisl&quot;</span>, image: <span class="hljs-string">&quot;cafeloisl&quot;</span>),
               <span class="hljs-type">Restaurant</span>(name: <span class="hljs-string">&quot;Petite Oyster&quot;</span>, image: <span class="hljs-string">&quot;petiteoyster&quot;</span>),
               <span class="hljs-type">Restaurant</span>(name: <span class="hljs-string">&quot;For Kee Restaurant&quot;</span>, image: <span class="hljs-string">&quot;forkeerestaurant&quot;</span>),
               <span class="hljs-type">Restaurant</span>(name: <span class="hljs-string">&quot;Po&apos;s Atelier&quot;</span>, image: <span class="hljs-string">&quot;posatelier&quot;</span>),
               <span class="hljs-type">Restaurant</span>(name: <span class="hljs-string">&quot;Bourke Street Bakery&quot;</span>, image: <span class="hljs-string">&quot;bourkestreetbakery&quot;</span>),
               <span class="hljs-type">Restaurant</span>(name: <span class="hljs-string">&quot;Haigh&apos;s Chocolate&quot;</span>, image: <span class="hljs-string">&quot;haighschocolate&quot;</span>),
               <span class="hljs-type">Restaurant</span>(name: <span class="hljs-string">&quot;Palomino Espresso&quot;</span>, image: <span class="hljs-string">&quot;palominoespresso&quot;</span>),
               <span class="hljs-type">Restaurant</span>(name: <span class="hljs-string">&quot;Upstate&quot;</span>, image: <span class="hljs-string">&quot;upstate&quot;</span>),
               <span class="hljs-type">Restaurant</span>(name: <span class="hljs-string">&quot;Traif&quot;</span>, image: <span class="hljs-string">&quot;traif&quot;</span>),
               <span class="hljs-type">Restaurant</span>(name: <span class="hljs-string">&quot;Graham Avenue Meats And Deli&quot;</span>, image: <span class="hljs-string">&quot;grahamavenuemeats&quot;</span>),
               <span class="hljs-type">Restaurant</span>(name: <span class="hljs-string">&quot;Waffle &amp; Wolf&quot;</span>, image: <span class="hljs-string">&quot;wafflewolf&quot;</span>),
               <span class="hljs-type">Restaurant</span>(name: <span class="hljs-string">&quot;Five Leaves&quot;</span>, image: <span class="hljs-string">&quot;fiveleaves&quot;</span>),
               <span class="hljs-type">Restaurant</span>(name: <span class="hljs-string">&quot;Cafe Lore&quot;</span>, image: <span class="hljs-string">&quot;cafelore&quot;</span>),
               <span class="hljs-type">Restaurant</span>(name: <span class="hljs-string">&quot;Confessional&quot;</span>, image: <span class="hljs-string">&quot;confessional&quot;</span>),
               <span class="hljs-type">Restaurant</span>(name: <span class="hljs-string">&quot;Barrafina&quot;</span>, image: <span class="hljs-string">&quot;barrafina&quot;</span>),
               <span class="hljs-type">Restaurant</span>(name: <span class="hljs-string">&quot;Donostia&quot;</span>, image: <span class="hljs-string">&quot;donostia&quot;</span>),
               <span class="hljs-type">Restaurant</span>(name: <span class="hljs-string">&quot;Royal Oak&quot;</span>, image: <span class="hljs-string">&quot;royaloak&quot;</span>),
               <span class="hljs-type">Restaurant</span>(name: <span class="hljs-string">&quot;CASK Pub and Kitchen&quot;</span>, image: <span class="hljs-string">&quot;caskpubkitchen&quot;</span>)
]
</code></pre>
<p>如果你是 Swift 新手，这里做个解释，数组的每一个项目表示一笔特定餐厅的纪录。当你进行更改后，你将会在Xcode 中见到一个错误，其指出遗失了<code>restaurantNames</code> 变量， 这很正常，因为我们刚才删除这个变量了。</p>
<p>现在更新 <code>body</code> 变量如下： </p>
<pre><code class="lang-swift"><span class="hljs-keyword">var</span> body: some <span class="hljs-type">View</span> {
    <span class="hljs-type">List</span>(restaurants, id: \.name) { restaurant <span class="hljs-keyword">in</span>
        <span class="hljs-type">HStack</span> {
            <span class="hljs-type">Image</span>(restaurant.image)
                .resizable()
                .frame(width: <span class="hljs-number">40</span>, height: <span class="hljs-number">40</span>)
                .cornerRadius(<span class="hljs-number">5</span>)
            <span class="hljs-type">Text</span>(restaurant.name)
        }
    }
    .listStyle(.plain)
}
</code></pre>
<p>看一下我们传入 <code>List</code> 的参数，我们没有传送范围，而是传送 <code>restaurants</code> 数组，并告诉 <code>List</code> 使用其 <code>name</code> 属性作为识别码。<code>List</code>  将逐一执行数组，并让我们知道它在闭包中正在处理的目前餐厅。因此，在闭包中，我们指示清单如何显示餐厅列，这里我们只在 <code>HStack</code> 中同时显示餐厅图片与餐厅名称。</p>
<p>一切都没有改变，UI 仍然相同，不过底层代码已经修改为利用 <code>List</code> 与资料集合了。</p>
<figure id="fig10.7"><img src="images/list/swiftui-list-7.png" alt="图 10.7.　与图 10.6 的 UI 相同"><figcaption>图 10.7.　与图 10.6 的 UI 相同</figcaption></figure>
<h4 id="%E9%81%B5%E5%BE%AA-identifiable-%E5%8D%94%E5%AE%9A">遵循 Identifiable 协定</h4>
<p>为了让你更了解 <code>List</code> 内 <code>id</code> 参数的用途，我们对 <code>restaurants</code> 数组做一个小变更。由于我们使用餐厅名称作为识别码，因此我们来看当有两笔资料具有相同的餐厅名称时会发生什么事？现在将 <code>restaurants</code> 数组中的“Upstate”更新为“Homei”，如下所示： </p>
<pre><code class="lang-swift"><span class="hljs-type">Restaurant</span>(name: <span class="hljs-string">&quot;Homei&quot;</span>, image: <span class="hljs-string">&quot;upstate&quot;</span>)
</code></pre>
<p>请注意，我们只更改“name”属性值，图片仍保持为 <code>upstate</code>，如图 10.8 所示。再次检查预览画布，看看你得到了什么。</p>
<figure id="fig10.8"><img src="images/list/swiftui-list-8.png" alt="图 10.8.　两间餐厅的名称相同"><figcaption>图 10.8.　两间餐厅的名称相同</figcaption></figure>
<p>你有看到图 10.8 中的问题吗？我们现在有两笔名称是“Homei”的纪录。你可能希望第二笔“Homei”纪录会显示 upstate 图片，但实际上，iOS 会以相同的文字与图片来渲染这两笔纪录。在代码中，我们告诉 <code>List</code>使用餐厅名称作为唯一的识别码，当两间餐厅的名称相同时，iOS 会将这两间餐厅视为同一餐厅，因此它重用相同的视图，并渲染相同的图片。</p>
<p>那么，你该如何修正这个问题呢？ </p>
<p>其实非常简单，你应该给每间餐厅一个唯一的识别码，而不是使用名称作为 ID。现在更新 <code>Restaurant</code> 结构如下：</p>
<pre><code class="lang-swift"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Restaurant</span> </span>{
    <span class="hljs-keyword">var</span> id = <span class="hljs-type">UUID</span>()
    <span class="hljs-keyword">var</span> name: <span class="hljs-type">String</span>
    <span class="hljs-keyword">var</span> image: <span class="hljs-type">String</span>
}
</code></pre>
<p>在上列的代码中，我们加入了 <code>id</code> 属性，并以唯一识别码来初始化它。这个 <code>UUID()</code>函数的作用是产生通用唯一的随机识别码，UUID 是由128 位元数所组成，因此理论上要同时产生两个相同识别码的机率几乎为零。</p>
<p>现在，每间餐厅应该皆有一个唯一的 ID，但是在修正这个错误之前，我们还需要再做一个修改。对于 <code>List</code>，将 <code>id</code> 参数的值从 <code>\.name</code>改为 <code>\.id</code>：</p>
<pre><code class="lang-swift"><span class="hljs-type">List</span>(restaurants, id: \.id)
</code></pre>
<p>这告诉 <code>List</code> 视图使用餐厅的 <code>id</code> 属性作为唯一的识别码。再看一遍预览，第二笔的“Homei”纪录应该显示它自己的图片了，如图 10.9 所示。</p>
<figure id="fig10.9"><img src="images/list/swiftui-list-9.png" alt="图 10.9.　错误已被修正而可显示正确的图片"><figcaption>图 10.9.　错误已被修正而可显示正确的图片</figcaption></figure>
<p>透过让 <code>Restaurant</code>  结构遵循 <code>Identifiable</code> 协定，我们可进一步简化代码。这个协定只有一个要求，就是实现协定的型别应该具备某种 <code>id</code> 作为唯一识别码。现在更新 <code>Restauran</code>t 来实现 <code>Identifiable</code> 协定，如下所示：</p>
<pre><code class="lang-swift"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">Restaurant</span>: <span class="hljs-title">Identifiable</span> </span>{
    <span class="hljs-keyword">var</span> id = <span class="hljs-type">UUID</span>()
    <span class="hljs-keyword">var</span> name: <span class="hljs-type">String</span>
    <span class="hljs-keyword">var</span> image: <span class="hljs-type">String</span>
}
</code></pre>
<p>由于 <code>Restaurant</code> 已经提供了唯一的 <code>id</code> 属性，因此符合协定的要求。</p>
<p>那么，这里实现 <code>Identifiable</code> 协定的目的是什么呢？它可以进一步节省一些代码，当 <code>Restaurant</code> 结构遵循 <code>Identifiable</code> 协定时，你可不使用 <code>id</code> 参数来初始化这个 <code>List</code>，更新后的清单视图代码，如下所示： </p>
<pre><code class="lang-swift"><span class="hljs-type">List</span>(restaurants) { restaurant <span class="hljs-keyword">in</span>
    <span class="hljs-type">HStack</span> {
        <span class="hljs-type">Image</span>(restaurant.image)
            .resizable()
            .frame(width: <span class="hljs-number">40</span>, height: <span class="hljs-number">40</span>)
            .cornerRadius(<span class="hljs-number">5</span>)
        <span class="hljs-type">Text</span>(restaurant.name)
    }
    .listStyle(.plain)
}
</code></pre>
<p>这就是使用 <code>List</code> 显示资料集合的方式。</p>
<h3 id="%E9%87%8D%E6%A7%8B%E7%A8%8B%E5%BC%8F%E7%A2%BC">重构代码</h3>
<p>代码运作正常，不过将代码重构，让它变得更好，始终是一件好事。你已经学过如何取出视图，现在我们将取出 <code>HStack</code> 至一个单独的结构中。按住键不放， 并点击 <code>HStack</code>， 选择“Extract subview”来取出代码， 并将结构重新命名为 <code>BasicImageRow</code>。</p>
<figure id="fig10.10"><img src="images/list/swiftui-list-10.png" alt="图 10.10.　取出子视图"><figcaption>图 10.10.　取出子视图</figcaption></figure>
<p>当你更改后，Xcode 会立即显示一个错误。由于取出的子视图没有 <code>restaurant</code> 属性，因此像这样更新<code>BasicImageRow</code> 结构，以声明 <code>restaurant</code> 属性： </p>
<pre><code class="lang-swift"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">BasicImageRow</span>: <span class="hljs-title">View</span> </span>{
    <span class="hljs-keyword">var</span> restaurant: <span class="hljs-type">Restaurant</span>

    <span class="hljs-keyword">var</span> body: some <span class="hljs-type">View</span> {
        <span class="hljs-type">HStack</span> {
            <span class="hljs-type">Image</span>(restaurant.image)
                .resizable()
                .frame(width: <span class="hljs-number">40</span>, height: <span class="hljs-number">40</span>)
                .cornerRadius(<span class="hljs-number">5</span>)
            <span class="hljs-type">Text</span>(restaurant.name)
        }
    }
}
</code></pre>
<p>接着，更新 <code>List</code> 视图来传送 <code>restaurant</code> 参数： </p>
<pre><code class="lang-swift"><span class="hljs-type">List</span>(restaurants) { restaurant <span class="hljs-keyword">in</span>
    <span class="hljs-type">BasicImageRow</span>(restaurant: restaurant)
}
</code></pre>
<p>现在一切都应该正常运作。这个清单视图渲染后看起来仍然相同，不过底层的代码更具易读性与组织性，而且更容易修改代码。例如：你将列建立为其他布局，如下所示： </p>
<pre><code class="lang-swift"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">FullImageRow</span>: <span class="hljs-title">View</span> </span>{
    <span class="hljs-keyword">var</span> restaurant: <span class="hljs-type">Restaurant</span>

    <span class="hljs-keyword">var</span> body: some <span class="hljs-type">View</span> {
        <span class="hljs-type">ZStack</span> {
            <span class="hljs-type">Image</span>(restaurant.image)
                .resizable()
                .aspectRatio(contentMode: .fill)
                .frame(height: <span class="hljs-number">200</span>)
                .cornerRadius(<span class="hljs-number">10</span>)
                .overlay(
                    <span class="hljs-type">Rectangle</span>()
                        .foregroundColor(.black)
                        .cornerRadius(<span class="hljs-number">10</span>)
                        .opacity(<span class="hljs-number">0.2</span>)
                )

            <span class="hljs-type">Text</span>(restaurant.name)
                .font(.system(.title, design: .rounded))
                .fontWeight(.black)
                .foregroundColor(.white)
        }
    }
}
</code></pre>
<p>这个列布局是用于显示更大的餐厅图片，并将餐厅名称叠在上面。由于我们已经重构代码，因此非常容易变更 App，来使用新的布局，你只需要在 <code>List</code> 闭包中，将 <code>BasicImageRow</code> 改成 <code>FullImageRow</code> 即可： </p>
<pre><code class="lang-swift"><span class="hljs-type">List</span>(restaurants) { restaurant <span class="hljs-keyword">in</span>
    <span class="hljs-type">FullImageRow</span>(restaurant: restaurant)
}
</code></pre>
<p>更改一行代码后，这个 App 会立即切换至另一个布局，如图 10.11 所示。</p>
<figure id="fig10.11"><img src="images/list/swiftui-list-11.png" alt="图 10.11.　变更列布局"><figcaption>图 10.11.　变更列布局</figcaption></figure>
<p>你可以进一步混合列布局， 以建立更有趣的 UI。举例而言， 新的设计是使用 <code>FullImageRow</code> 来显示前两列的资料，其余的列则利用 <code>BasicImageRow</code>，如图 10.12 所示。你可以更新 <code>List</code> 如下： </p>
<pre><code class="lang-swift"><span class="hljs-type">List</span> {
    <span class="hljs-type">ForEach</span>(restaurants.<span class="hljs-built_in">indices</span>, id: \.<span class="hljs-keyword">self</span>) { index <span class="hljs-keyword">in</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-number">0</span>...<span class="hljs-number">1</span>).<span class="hljs-built_in">contains</span>(index) {
            <span class="hljs-type">FullImageRow</span>(restaurant: <span class="hljs-keyword">self</span>.restaurants[index])
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-type">BasicImageRow</span>(restaurant: <span class="hljs-keyword">self</span>.restaurants[index])
        }
    }
}
.listStyle(.plain)
</code></pre>
<p>由于我们需要检索列索引，因此我们向 <code>List</code> 传送餐厅资料的范围。在闭包中，我们检查 <code>index</code> 的值来决定要使用哪一种列布局。</p>
<figure id="fig10.12"><img src="images/list/swiftui-list-12.png" alt="图 10.12.　使用两种不同的列布局来建立清单视图"><figcaption>图 10.12.　使用两种不同的列布局来建立清单视图</figcaption></figure>
<h3 id="%E6%9B%B4%E6%94%B9%E8%A1%8C%E5%88%86%E9%9A%94%E7%AC%A6%E7%9A%84%E9%A1%8F%E8%89%B2">更改行分隔符的颜色</h3>
<p>从 iOS 15 开始，Apple 为开发人员提供了自定义列表视图外观的选项。 要更改行分隔符的色调颜色，可以使用 <code>listRowSeparatorTint</code> 修饰符，如下所示：</p>
<pre><code class="lang-swift"><span class="hljs-type">List</span>(restaurants) { restaurant <span class="hljs-keyword">in</span>
    <span class="hljs-type">ForEach</span>(restaurants.<span class="hljs-built_in">indices</span>, id: \.<span class="hljs-keyword">self</span>) { index <span class="hljs-keyword">in</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-number">0</span>...<span class="hljs-number">1</span>).<span class="hljs-built_in">contains</span>(index) {
            <span class="hljs-type">FullImageRow</span>(restaurant: <span class="hljs-keyword">self</span>.restaurants[index])
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-type">BasicImageRow</span>(restaurant: <span class="hljs-keyword">self</span>.restaurants[index])
        }
    }
    .listRowSeparatorTint(.green)
}
.listStyle(.plain)
</code></pre>
<p>在以上的代码中，我们将行分隔符的颜色更改为绿色。</p>
<h3 id="%E9%9A%B1%E8%97%8F%E5%88%97%E8%A1%A8%E5%88%86%E9%9A%94%E7%B7%9A">隐藏列表分隔线</h3>
<p>iOS 15 引入了其中一个最受期待的 List 功能。 你终于可以使用 <code>listRowSeparator</code> 修饰器并将其值设置为 <code>.hidden</code> 以隐藏分隔线。以下是一个范例：</p>
<pre><code class="lang-swift"><span class="hljs-type">List</span> {
    <span class="hljs-type">ForEach</span>(restaurants.<span class="hljs-built_in">indices</span>) { index <span class="hljs-keyword">in</span>
        <span class="hljs-keyword">if</span> (<span class="hljs-number">0</span>...<span class="hljs-number">1</span>).<span class="hljs-built_in">contains</span>(index) {
            <span class="hljs-type">FullImageRow</span>(restaurant: <span class="hljs-keyword">self</span>.restaurants[index])
        } <span class="hljs-keyword">else</span> {
            <span class="hljs-type">BasicImageRow</span>(restaurant: <span class="hljs-keyword">self</span>.restaurants[index])
        }
    }

    .listRowSeparator(.hidden)
}
.listStyle(.plain)
</code></pre>
<p><code>listRowSeparator</code> 修饰器应该嵌入在 <code>List</code> 视图中。 要使列表分隔线再次出现，你可以将修饰器的值设置为<code>.visible</code>。 又或者你可以简单地删除 <code>listRowSeparator</code> 修饰器。</p>
<p>如果你想对列表分隔线进行更精细的控制，可以使用<code>.listRowSeparator</code>修饰器内的 <code>edges</code>参数。 比如说，如果你想让分隔线保持在列表视图的顶部，你可以这样写代码：</p>
<pre><code class="lang-swift">.listRowSeparator(.hidden, edges: .bottom)
</code></pre>
<h3 id="%E8%87%AA%E5%AE%9A%E7%BE%A9%E6%BB%BE%E5%8B%95%E5%8D%80%E5%9F%9F%E7%9A%84%E8%83%8C%E6%99%AF">自定义滚动区域的背景</h3>
<figure id="fig10.13"><img src="images/list/swiftui-list-13.png" alt="图 10.13. 更改可滚动区域的颜色"><figcaption>图 10.13. 更改可滚动区域的颜色</figcaption></figure>
<p>在 iOS 16 中，你可以自定义列表视图的可滚动区域的颜色。 只需将 <code>scrollContentBackground</code> 修饰符附加到 <code>List</code> 视图并将其设置为您喜欢的颜色。 这是一个例子：</p>
<pre><code class="lang-swift"><span class="hljs-type">List</span>(restaurants) { restaurant <span class="hljs-keyword">in</span>
    .
    .
    .
}
.scrollContentBackground(<span class="hljs-type">Color</span>.yellow)
</code></pre>
<p>除了使用纯色之外，你还可以使用图像作为背景。 更新这样的代码试试：</p>
<pre><code class="lang-swift"><span class="hljs-type">List</span>(restaurants) { restaurant <span class="hljs-keyword">in</span>
    .
    .
    .
}
.background {
    <span class="hljs-type">Image</span>(<span class="hljs-string">&quot;homei&quot;</span>)
        .resizable()
        .scaledToFill()
        .clipped()
}
.scrollContentBackground(<span class="hljs-type">Color</span>.clear)
</code></pre>
<p>我们使用<code>background</code>修饰符来设置背景图片， 然后我们将 <code>scrollContentBackground</code> 修饰符设置为 <code>Color.clear</code> 以使可滚动区域透明。</p>
<h3 id="%E4%BD%9C%E6%A5%AD">作业</h3>
<p>在进入下一章之前，自我挑战一下，建立如图 10.13 所示的清单视图，它看起来有些复杂，但是若你完全了解我在本章所教过的内容，则你应该能够建立这个 UI。请花点时间来练习这个作业，我保证你会学习到很多。</p>
<p>为了节省你寻找图片的时间，你可以至下列网站：<a href="https://www.appcoda.com/resources/swiftui/SwiftUIArticleImages.zip" target="_blank">https://www.appcoda.com/resources/swiftui/SwiftUIArticleImages.zip</a> 。</p>
<figure id="fig10.14"><img src="images/list/swiftui-list-13.jpg" alt="图 10.13.　建立一个多样化列布局的清单视图"><figcaption>图 10.13.　建立一个多样化列布局的清单视图</figcaption></figure>
<p>在本章所准备的范例档中，有完整的专案与作业解答可以下载： </p>
<ul>
<li>范例专案 (<a href="https://www.appcoda.com/resources/swiftui4/SwiftUIList.zip" target="_blank">https://www.appcoda.com/resources/swiftui4/SwiftUIList.zip</a>)</li>
<li>作业解答 (<a href="https://www.appcoda.com/resources/swiftui4/SwiftUIListExercise.zip" target="_blank">https://www.appcoda.com/resources/swiftui4/SwiftUIListExercise.zip</a>)</li>
</ul>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="./swiftui-animation.html" class="navigation navigation-prev " aria-label="Previous page: 基础动画与转场"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="./swiftui-navigation.html" class="navigation navigation-next " aria-label="Next page: 导览UI与导览列客制化运用"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="gitbook/app.js"></script>

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":"white","family":"serif","size":3},"image-captions":{"caption":"_CAPTION_","variable_name":"_pictures"}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
