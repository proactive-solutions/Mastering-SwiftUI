<!DOCTYPE HTML>
<html lang="zh-tw" >
    
    <head>
        
        <meta charset=utf-8"UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=11; IE=10; IE=9; IE=8; IE=7; IE=EDGE" />
        <title>导览UI与导览列客制化运用 | 精通 SwiftUI - iOS 16 版</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.0.1">
        <meta name="author" content="Simon Ng">
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    <link rel="next" href="./swiftui-modal.html" />
    
    
    <link rel="prev" href="./swiftui-list.html" />
    

        
    </head>
    <body>
        
        
    <link rel="stylesheet" href="gitbook/style.css">
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-image-captions/image-captions.css">
        
    
    
        <link rel="stylesheet" href="././styles/website.css">
    

        
    <div class="book" data-level="11" data-basepath="." data-revision="Thu Dec 01 2022 17:36:55 GMT+0800 (HKT)">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="输入并搜寻" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
            
            <li>
                <a href="https://www.appcoda.com.tw" target="blank" class="custom-link">Made by AppCoda</a>
            </li>
        
            
            <li>
                <a href="https://www.appcoda.com.tw/contact" target="blank" class="custom-link">Contact us / Support</a>
            </li>
        
            
            <li>
                <a href="http://twitter.com/share?text=Mastering%20SwiftUI%20via%20@appcodamobile&amp;url=https://www.appcoda.com.tw/swiftui/&amp;hashtags=swiftlang" target="blank" class="custom-link">Tweet this book</a>
            </li>
        
        

        
        <li class="divider"></li>
        

        
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="./index.html">
                        <i class="fa fa-check"></i>
                        
                        序言
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="swiftui-basics.html">
            
                
                    <a href="./swiftui-basics.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        SwiftUI 介绍
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="swiftui-text.html">
            
                
                    <a href="./swiftui-text.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        SwiftUI 入门 - 文字的处理
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3" data-path="swiftui-images.html">
            
                
                    <a href="./swiftui-images.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        图片的处理
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4" data-path="swiftui-stacks.html">
            
                
                    <a href="./swiftui-stacks.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        以堆叠布局使用者介面
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5" data-path="swiftui-scrollview.html">
            
                
                    <a href="./swiftui-scrollview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        ScrollView 与 Carousel UI 的建立
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="6" data-path="swiftui-buttons.html">
            
                
                    <a href="./swiftui-buttons.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        SwiftUI 按钮与渐层
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="7" data-path="swiftui-state.html">
            
                
                    <a href="./swiftui-state.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        状态(State)与绑定(Binding)
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="8" data-path="swiftui-path-shape.html">
            
                
                    <a href="./swiftui-path-shape.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        实现路径(Path)与形状(Shape)来画线与圆饼图
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="9" data-path="swiftui-animation.html">
            
                
                    <a href="./swiftui-animation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                        基础动画与转场
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="10" data-path="swiftui-list.html">
            
                
                    <a href="./swiftui-list.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.</b>
                        
                        动态列表、 ForEach 与 Identifiable 的使用方法
                    </a>
                
            
            
        </li>
    
        <li class="chapter active" data-level="11" data-path="swiftui-navigation.html">
            
                
                    <a href="./swiftui-navigation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.</b>
                        
                        导览UI与导览列客制化运用
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="12" data-path="swiftui-modal.html">
            
                
                    <a href="./swiftui-modal.html">
                        <i class="fa fa-check"></i>
                        
                            <b>12.</b>
                        
                        强制回应视图、浮动按钮与提示的实现
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="13" data-path="swiftui-form.html">
            
                
                    <a href="./swiftui-form.html">
                        <i class="fa fa-check"></i>
                        
                            <b>13.</b>
                        
                        以选取器(Picker)、开关(Toggle)与步进器(Stepper)来建立一个表单
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="14" data-path="swiftui-form-data.html">
            
                
                    <a href="./swiftui-form-data.html">
                        <i class="fa fa-check"></i>
                        
                            <b>14.</b>
                        
                        使用 Combine 与 Environment 物件进行资料分享
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="15" data-path="swiftui-form-registration.html">
            
                
                    <a href="./swiftui-form-registration.html">
                        <i class="fa fa-check"></i>
                        
                            <b>15.</b>
                        
                        以 Combine 与 视图模型建立一个注册表单
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="16" data-path="swiftui-actionsheet-context.html">
            
                
                    <a href="./swiftui-actionsheet-context.html">
                        <i class="fa fa-check"></i>
                        
                            <b>16.</b>
                        
                        滑动删除、内容选单与动作列表
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="17" data-path="swiftui-gestures.html">
            
                
                    <a href="./swiftui-gestures.html">
                        <i class="fa fa-check"></i>
                        
                            <b>17.</b>
                        
                        认识手势（Gestures）
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="18" data-path="swiftui-bottom-sheet.html">
            
                
                    <a href="./swiftui-bottom-sheet.html">
                        <i class="fa fa-check"></i>
                        
                            <b>18.</b>
                        
                        以SwiftUI 手势与 GeometryReader 建立一个底部展开式页面
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="19" data-path="swiftui-trip-tinder.html">
            
                
                    <a href="./swiftui-trip-tinder.html">
                        <i class="fa fa-check"></i>
                        
                            <b>19.</b>
                        
                        使用手势与动画建立 Tinder 风格的 UI
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="20" data-path="swiftui-advanced-animations.html">
            
                
                    <a href="./swiftui-advanced-animations.html">
                        <i class="fa fa-check"></i>
                        
                            <b>20.</b>
                        
                        建立像 Apple Wallet App 的动画和转场效果
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="21" data-path="swiftui-json.html">
            
                
                    <a href="./swiftui-json.html">
                        <i class="fa fa-check"></i>
                        
                            <b>21.</b>
                        
                        JSON、滑杆的运用与资料过滤
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="22" data-path="swiftui-core-data.html">
            
                
                    <a href="./swiftui-core-data.html">
                        <i class="fa fa-check"></i>
                        
                            <b>22.</b>
                        
                        如何使用 Core Data 建立 ToDo App
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="23" data-path="swiftui-uikit.html">
            
                
                    <a href="./swiftui-uikit.html">
                        <i class="fa fa-check"></i>
                        
                            <b>23.</b>
                        
                        利用 UIViewRepresentable 整合UIKit 组件
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="24" data-path="swiftui-searchbar.html">
            
                
                    <a href="./swiftui-searchbar.html">
                        <i class="fa fa-check"></i>
                        
                            <b>24.</b>
                        
                        建立搜寻栏视图并使用自订绑定（Custom Binding）
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="25" data-path="swiftui-real-world-app.html">
            
                
                    <a href="./swiftui-real-world-app.html">
                        <i class="fa fa-check"></i>
                        
                            <b>25.</b>
                        
                        把所学应用出来！构建个人理财App
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="26" data-path="swiftui-appstoreanimation.html">
            
                
                    <a href="./swiftui-appstoreanimation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>26.</b>
                        
                        创建类似App Store使用的动画视图转换
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="27" data-path="swiftui-carousel.html">
            
                
                    <a href="./swiftui-carousel.html">
                        <i class="fa fa-check"></i>
                        
                            <b>27.</b>
                        
                        如何建立图像轮播（Image Carousel）
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="28" data-path="swiftui-expandable-list.html">
            
                
                    <a href="./swiftui-expandable-list.html">
                        <i class="fa fa-check"></i>
                        
                            <b>28.</b>
                        
                        如何建立展开式列表视图和大纲视图
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="29" data-path="swiftui-gridlayout.html">
            
                
                    <a href="./swiftui-gridlayout.html">
                        <i class="fa fa-check"></i>
                        
                            <b>29.</b>
                        
                        使用 LazyVGrid 和 LazyHGrid 构建集合视图
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="30" data-path="swiftui-progress-ring.html">
            
                
                    <a href="./swiftui-progress-ring.html">
                        <i class="fa fa-check"></i>
                        
                            <b>30.</b>
                        
                        使用 Shape 和 Animatable 开发带动画的环形进度条
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="31" data-path="swiftui-library.html">
            
                
                    <a href="./swiftui-library.html">
                        <i class="fa fa-check"></i>
                        
                            <b>31.</b>
                        
                        如何使用 AnimatableModifier 和 LibraryContentProvider
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="32" data-path="swiftui-texteditor.html">
            
                
                    <a href="./swiftui-texteditor.html">
                        <i class="fa fa-check"></i>
                        
                            <b>32.</b>
                        
                        使用 TextEditor 支持多行文字输入
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="33" data-path="swiftui-matchedgeometry.html">
            
                
                    <a href="./swiftui-matchedgeometry.html">
                        <i class="fa fa-check"></i>
                        
                            <b>33.</b>
                        
                        使用 matchedGeometryEffect为 App 建立绚丽的视图动画
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="34" data-path="swiftui-grid-animation.html">
            
                
                    <a href="./swiftui-grid-animation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>34.</b>
                        
                        ScrollViewReader 和网格动画
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="35" data-path="swiftui-tabview.html">
            
                
                    <a href="./swiftui-tabview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>35.</b>
                        
                        标签视图的运用与自订标签列
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="36" data-path="swiftui-asyncimage.html">
            
                
                    <a href="./swiftui-asyncimage.html">
                        <i class="fa fa-check"></i>
                        
                            <b>36.</b>
                        
                        利用 AsyncImage 非同步加载和显示图像
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="37" data-path="swiftui-searchable.html">
            
                
                    <a href="./swiftui-searchable.html">
                        <i class="fa fa-check"></i>
                        
                            <b>37.</b>
                        
                        利用 Searchable 建立搜寻栏
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="38" data-path="swiftui-charts.html">
            
                
                    <a href="./swiftui-charts.html">
                        <i class="fa fa-check"></i>
                        
                            <b>38.</b>
                        
                        利用 Charts 框架建立图表
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="39" data-path="swiftui-live-text.html">
            
                
                    <a href="./swiftui-live-text.html">
                        <i class="fa fa-check"></i>
                        
                            <b>39.</b>
                        
                        利用 Live Text API 从图片中撷取文本
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="40" data-path="swiftui-sharelink.html">
            
                
                    <a href="./swiftui-sharelink.html">
                        <i class="fa fa-check"></i>
                        
                            <b>40.</b>
                        
                        透过 ShareLink 来分享文本和图像等资料
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="41" data-path="swiftui-imagerenderer.html">
            
                
                    <a href="./swiftui-imagerenderer.html">
                        <i class="fa fa-check"></i>
                        
                            <b>41.</b>
                        
                        利用 ImageRenderer API 轻松把 SwiftUI 视图转换为图像
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="42" data-path="swiftui-pdf-doc.html">
            
                
                    <a href="./swiftui-pdf-doc.html">
                        <i class="fa fa-check"></i>
                        
                            <b>42.</b>
                        
                        如何把 SwiftUI 视图转换为 PDF 文件
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="43" data-path="swiftui-gauge.html">
            
                
                    <a href="./swiftui-gauge.html">
                        <i class="fa fa-check"></i>
                        
                            <b>43.</b>
                        
                        使用 Gauge 视图显示进度并创建速度计
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="44" data-path="swiftui-grid.html">
            
                
                    <a href="./swiftui-grid.html">
                        <i class="fa fa-check"></i>
                        
                            <b>44.</b>
                        
                        使用Grid API 创建网格布局
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="45" data-path="swiftui-anylayout.html">
            
                
                    <a href="./swiftui-anylayout.html">
                        <i class="fa fa-check"></i>
                        
                            <b>45.</b>
                        
                        利用 AnyLayout 切换 UI 布局
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="46" data-path="swiftui-navigationstack.html">
            
                
                    <a href="./swiftui-navigationstack.html">
                        <i class="fa fa-check"></i>
                        
                            <b>46.</b>
                        
                        使用新的 NavigationStack 视图构建资料导向的导航
                    </a>
                
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                本书使用 GitBook 释出
            </a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="目录"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="搜寻"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="字型设定"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">衬线体</button>
        <button type="button" data-font="1" class="button">无衬线体</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">白色</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">棕褐色</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">夜间</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="分享"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    分享到 Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    分享到 Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    分享到 Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    分享到 Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    分享到 Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="./" >精通 SwiftUI - iOS 16 版</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="%E7%AC%AC-11-%E7%AB%A0-br-%E9%81%8B%E7%94%A8%E5%B0%8E%E8%A6%BD-ui-%E8%88%87%E5%B0%8E%E8%A6%BD%E5%88%97%E5%AE%A2%E8%A3%BD%E5%8C%96">第 11 章<br>运用导览 UI 与导览列客制化</h1>
<p>在大多数的 App 中（尤其是以内容为基础的 App），你应该体验过导览介面。这类型的 UI 通常有一个包含资料清单的导览列，并且它让使用者点击内容时导览至细节视图。</p>
<p>在 UIKit 中，我们可以使用 UINavigationController 来实现这类型的介面。在 SwiftUI 中，Apple 称其为“NavigationView”。由 iOS 16 开始，这个 “NavigationView” 以 “NavigationStack”取替。在本章中，我详细解说导览 UI 的实现，并教你如何进行一些自定义。和往常一样，我们将进行几个范例专案，以让你获得一些使用 NavigationStack 的实务经验。</p>
<figure id="fig11.1"><img src="images/navigation/swiftui-navigation-1.jpg" alt="图 11.1.　范例专案的导览介面"><figcaption>图 11.1.　范例专案的导览介面</figcaption></figure>
<h3 id="%E6%BA%96%E5%82%99%E8%B5%B7%E5%A7%8B%E5%B0%88%E6%A1%88">准备起始专案</h3>
<p>让我们开始并实现一个我们之前使用导览 UI 建立的范例专案。那么，首先至下列网址下载起始专案：<a href="https://www.appcoda.com/resources/swiftui4/SwiftUINavigationListStarter.zip" target="_blank">https://www.appcoda.com/resources/swiftui4/SwiftUINavigationListStarter.zip</a> 。下载后开启专案，并看一下预览，你应该对于这个范例 App 非常熟悉，它只显示一个餐厅列表，如图 11.2 所示。</p>
<figure id="fig11.2"><img src="images/navigation/swiftui-navigation-2.png" alt="图 11.2.　起始专案应显示一个简单的清单视图"><figcaption>图 11.2.　起始专案应显示一个简单的清单视图</figcaption></figure>
<p>我们所要做的是，将这个清单视图嵌入至导览视图中。</p>
<h3 id="%E5%AF%A6%E4%BD%9C%E5%B0%8E%E8%A6%BD%E8%A6%96%E5%9C%96">实现导览视图</h3>
<p>在旧版的 iOS，SwiftUI 框架提供一个名为 <code>NavigationView</code> 的视图来建立导览 UI。要将清单视图嵌入至<code>NavigationView</code> 中，你所需要做的是使用 <code>NavigationView</code> 包裹 List ，如下所示： </p>
<pre><code class="lang-swift"><span class="hljs-type">NavigationView</span> {
    <span class="hljs-type">List</span> {
        <span class="hljs-type">ForEach</span>(restaurants) { restaurant <span class="hljs-keyword">in</span>
            <span class="hljs-type">BasicImageRow</span>(restaurant: restaurant)
        }
    }
    .listStyle(.plain)
}
</code></pre>
<p>在 iOS 16 中，Apple 将 <code>NavigationView</code> 替换为 <code>NavigationStack</code>。 你仍然可以使用 <code>NavigationView</code> 来创建导航视图， 但建议使用 <code>NavigationStack</code>，因为 <code>NavigationView</code> 最终会从 SDK 中移除。</p>
<p>要使用 <code>NavigationStack</code> 创建导航视图，你可以将以上的代码写成这样：</p>
<pre><code class="lang-swift"><span class="hljs-type">NavigationStack</span> {
    <span class="hljs-type">List</span> {
        <span class="hljs-type">ForEach</span>(restaurants) { restaurant <span class="hljs-keyword">in</span>
            <span class="hljs-type">BasicImageRow</span>(restaurant: restaurant)
        }
    }
    .listStyle(.plain)
}
</code></pre>
<p>进行更改后，你应该会看到一个空的导航栏。 要为栏加入标题，请使用 <code>navigationBarTitle</code> 修饰符，如下所示：</p>
<pre><code class="lang-swift"><span class="hljs-type">NavigationStack</span> {
    <span class="hljs-type">List</span> {
        <span class="hljs-type">ForEach</span>(restaurants) { restaurant <span class="hljs-keyword">in</span>
            <span class="hljs-type">BasicImageRow</span>(restaurant: restaurant)
        }
    }
    .listStyle(.plain)

    .navigationTitle(<span class="hljs-string">&quot;Restaurants&quot;</span>)
}
</code></pre>
<p>现在，该 App 应该有一个具大标题的导览列，如图 11.3 所示。</p>
<figure id="fig11.3"><img src="images/navigation/swiftui-navigation-3.png" alt="图 11.3.　基本的导览UI"><figcaption>图 11.3.　基本的导览UI</figcaption></figure>
<h3 id="%E4%BD%BF%E7%94%A8-navigationlink-%E5%82%B3%E9%80%81%E8%B3%87%E6%96%99%E8%87%B3%E7%B4%B0%E7%AF%80%E8%A6%96%E5%9C%96">使用 NavigationLink 传送资料至细节视图</h3>
<p>至目前为止，我们只是在清单视图中加入一个导览列。我们通常使用导览介面来让使用者导览至细节视图，以显示所选项目的细节。对于此范例，我们将建立一个简单的细节视图，以显示餐厅的大图，如图 11.4 所示。</p>
<figure id="fig11.4"><img src="images/navigation/swiftui-navigation-4.png" alt="图 11.4.　内容视图与细节视图"><figcaption>图 11.4.　内容视图与细节视图</figcaption></figure>
<p>让我们从细节视图开始。在 <code>ContentView.swift</code> 档的结尾处，插入下列的代码，以建立细节视图： </p>
<pre><code class="lang-swift"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">RestaurantDetailView</span>: <span class="hljs-title">View</span> </span>{
    <span class="hljs-keyword">var</span> restaurant: <span class="hljs-type">Restaurant</span>

    <span class="hljs-keyword">var</span> body: some <span class="hljs-type">View</span> {
        <span class="hljs-type">VStack</span> {
            <span class="hljs-type">Image</span>(restaurant.image)
                .resizable()
                .aspectRatio(contentMode: .fit)

            <span class="hljs-type">Text</span>(restaurant.name)
                .font(.system(.title, design: .rounded))
                .fontWeight(.black)

            <span class="hljs-type">Spacer</span>()
        }
    }
}
</code></pre>
<p>细节视图就像 <code>View</code>型别的其他 SwiftUI 视图一样，它的布局非常简单，只显示餐厅的图片及名称。<code>RestaurantDetailView</code> 结构还带入一个 <code>Restaurant</code> 物件，以检索餐厅的图片及名称。</p>
<p>好的，细节视图已经准备就绪，问题是你如何将内容视图中所选的餐厅传送至此细节视图呢？ </p>
<p>SwiftUI 提供一个名为 <code>NavigationLink</code> 的特殊按钮，它能够侦测使用者的触控，并触发导览显示，NavigationLink 的基本用法如下： </p>
<pre><code class="lang-swift"><span class="hljs-type">NavigationLink</span>(destination: <span class="hljs-type">DetailView</span>()) {
    <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;Press me for details&quot;</span>)
}
</code></pre>
<p>你可在 <code>destination</code> 参数中指定目标视图，并在闭包中实现其外观。对于范例 App， 应该在点击任何一间餐厅时，导览至细节视图。在这个范例中，我们对每一列应用 <code>NavigationLink</code>。更新 <code>List</code> 视图如下： </p>
<pre><code class="lang-swift"><span class="hljs-type">List</span> {
    <span class="hljs-type">ForEach</span>(restaurants) { restaurant <span class="hljs-keyword">in</span>
        <span class="hljs-type">NavigationLink</span>(destination: <span class="hljs-type">RestaurantDetailView</span>(restaurant: restaurant)) {
            <span class="hljs-type">BasicImageRow</span>(restaurant: restaurant)
        }
    }
}
.listStyle(.plain)
</code></pre>
<p>在上列的代码中， 我们告诉 <code>NavigationLink</code> 在使用者选择餐厅时， 导览至 <code>RestaurantDetailView</code>。我们也将所选的餐厅传送至细节视图，以进行显示。这就是建立导览介面与执行资料传送所需的全部内容。</p>
<figure id="fig11.5"><img src="images/navigation/swiftui-navigation-5.png" alt="图 11.5.　执行 App 来测试导览"><figcaption>图 11.5.　执行 App 来测试导览</figcaption></figure>
<p>在画布中，你应该注意到每列资料皆已加入了一个揭露图示。如图 11.5 所示，你应该能够在选择其中一间餐厅后，导览至细节视图。另外，你可以点击“返回”（Back ）按钮来导览回内容视图。整个导览由 <code>NavigationStack</code> 自动渲染。</p>
<h3 id="%E8%87%AA%E8%A8%82%E5%B0%8E%E8%A6%BD%E5%88%97">自订导览列</h3>
<p>首先，我们来讨论导览列的显示模式。预设情况下，导览列是设定为显示大标题，但当你向上滚动清单时，导览列会变小，这是 Apple 导入“大标题”（Large Title ）导览列后的预设行为。</p>
<p>如果你想要使导览列更小型，并禁用大标题，你可以在 <code>navigationBarTitle</code> 修饰器之下加入<code>navigationBarTitleDisplayMode</code> 修饰器： </p>
<pre><code class="lang-swift">.navigationBarTitleDisplayMode(.inline)
</code></pre>
<p>这个参数控制导览列的外观，不论它应显示大标题导览列还是小型导览列，而预设是设定为 <code>.automatic</code>，即表示是使用大标题。在上列的代码中，我们将其设定为 <code>.inline</code>，即表示 iOS 使用小型导览列，如图 11.6 所示。</p>
<figure id="fig11.6"><img src="images/navigation/swiftui-navigation-6.png" alt="图 11.6.　设定显示模式为“.inline”来使用小型导览列"><figcaption>图 11.6.　设定显示模式为“.inline”来使用小型导览列</figcaption></figure>
<p>现在，我们将显示模式改为  <code>.automatic</code>，看看会得到什么，导览列应该会再次变成大标题导览列。</p>
<pre><code class="lang-swift">.navigationBarTitleDisplayMode(.automatic)
</code></pre>
<h4 id="%E8%A8%AD%E5%AE%9A%E5%AD%97%E5%9E%8B%E8%88%87%E9%A1%8F%E8%89%B2">设定字型与颜色</h4>
<p>接下来，我们来看如何变更标题的字型与颜色。在撰写本章时，SwiftUI 还没有修饰器来让开发人员设定导览列的字型及颜色，而我们需要使用 UIKit 所提供的 <code>UINavigation BarAppearance</code> API。</p>
<p>举例而言，我们要将导览列的标题颜色变更为红色、字型变更为 <code>Arial Rounded MT Bold</code>，则我们可以在 init() 函数中建立一个 <code>UINavigationBarAppearance</code> 物件，并相应地设定属性。在 <code>ContentView</code> 中插入下列的函数： </p>
<pre><code class="lang-swift"><span class="hljs-keyword">init</span>() {
    <span class="hljs-keyword">let</span> navBarAppearance = <span class="hljs-type">UINavigationBarAppearance</span>()
    navBarAppearance.largeTitleTextAttributes = [.foregroundColor: <span class="hljs-type">UIColor</span>.red, .font: <span class="hljs-type">UIFont</span>(name: <span class="hljs-string">&quot;ArialRoundedMTBold&quot;</span>, size: <span class="hljs-number">35</span>)!]
    navBarAppearance.titleTextAttributes = [.foregroundColor: <span class="hljs-type">UIColor</span>.red, .font: <span class="hljs-type">UIFont</span>(name: <span class="hljs-string">&quot;ArialRoundedMTBold&quot;</span>, size: <span class="hljs-number">20</span>)!]

    <span class="hljs-type">UINavigationBar</span>.appearance().standardAppearance = navBarAppearance
    <span class="hljs-type">UINavigationBar</span>.appearance().scrollEdgeAppearance = navBarAppearance
    <span class="hljs-type">UINavigationBar</span>.appearance().compactAppearance = navBarAppearance
}
</code></pre>
<p><code>largeTitleTextAttributes</code> 属性用于设定大尺寸标题的文字属性，而 <code>titleTextAttributes</code> 属性则用于设定标准尺寸标题的文字属性。当我们设定 <code>navBarAppearance</code> 后，将其它指定给三个外观属性，包括<code>standardAppearance</code>、<code>scrollEdgeAppearance</code> 与 <code>compactAppearance</code>。如前所述，如果需要的话，你可以为 <code>scrollEdgeAppearance</code> 与 <code>compactAppearance</code> 建立及指定一个单独的外观物件。</p>
<figure id="fig11.7"><img src="images/navigation/swiftui-navigation-7.png" alt="图 11.7.　对大尺寸标题与标准尺寸标题变更字型与颜色"><figcaption>图 11.7.　对大尺寸标题与标准尺寸标题变更字型与颜色</figcaption></figure>
<h4 id="%E3%80%8C%E8%BF%94%E5%9B%9E%E3%80%8D%E6%8C%89%E9%88%95%E7%9A%84%E5%9C%96%E7%89%87%E8%88%87%E9%A1%8F%E8%89%B2">“返回”按钮的图片与颜色</h4>
<p>导览视图的“返回”（Back ）按钮预设为蓝色，其使用V 形图示（chevron icon ）来表示“返回”，如图 11.8 所示。透过使用 <code>UINavigationBarAppearance</code>  API，你可以自订颜色、甚至是“返回”按钮的指示器图片。</p>
<figure id="fig11.8"><img src="images/navigation/swiftui-navigation-8.png" alt="图 11.8.　标准的“返回”按钮"><figcaption>图 11.8.　标准的“返回”按钮</figcaption></figure>
<p>我们来看这个自定义是否如何工作的。要变更指示器的图片，你可以调用 <code>setBackIndicatorImage</code> 方法，并提供自己的 <code>UIImage</code>。这里，我设定系统图片为 <code>arrow.turn. up.left</code>。</p>
<pre><code class="lang-swift">navBarAppearance.setBackIndicatorImage(<span class="hljs-type">UIImage</span>(systemName: <span class="hljs-string">&quot;arrow.turn.up.left&quot;</span>), transitionMaskImage: <span class="hljs-type">UIImage</span>(systemName: <span class="hljs-string">&quot;arrow.turn.up.left&quot;</span>))
</code></pre>
<p>对于“返回”按钮的颜色，你可以透过设置 <code>accentColor</code> 属性来更改它，如下所示：</p>
<pre><code class="lang-swift"><span class="hljs-type">NavigationStack</span> {
  .
  .
  .
}
.accentColor(.black)
</code></pre>
<p>如果你已经进行变更，则执行该 App 来快速测试，“返回”按钮应该如图 11.9 所示。</p>
<figure id="fig11.9"><img src="images/navigation/swiftui-navigation-9.png" alt="图 11.9.　自订“返回”按钮的外观"><figcaption>图 11.9.　自订“返回”按钮的外观</figcaption></figure>
<h4 id="%E8%87%AA%E8%A8%82%E8%BF%94%E5%9B%9E%E6%8C%89%E9%88%95">自订返回按钮</h4>
<p>除了使用  UIKit 的 API 来自订返回按钮以外，另一个方式为隐藏返回按钮，利用 SwiftUI 自己建立一个返回按钮，要隐藏返回按钮，如下所示，你可以使用  <code>.navigationBarBackButtonHidden</code> 修饰器，并将其值设定为 true：</p>
<pre><code class="lang-swift">.navigationBarBackButtonHidden(<span class="hljs-built_in">true</span>)
</code></pre>
<p>SwiftUI 还提供了一个名为 <code>toolbar</code> 的修饰符，用于创建导航栏项目。 例如，你可以使用所选餐厅的名称创建一个返回按钮，如下所示：</p>
<pre><code class="lang-swift">.toolbar {
    <span class="hljs-type">ToolbarItem</span>(placement: .navigationBarLeading) {
        <span class="hljs-type">Button</span> {
            dismiss()
        } label: {
            <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;<span class="hljs-subst">\(Image(systemName: &quot;chevron.<span class="hljs-keyword">left</span>&quot;)</span>) <span class="hljs-subst">\(restaurant.name)</span>&quot;</span>)
                .foregroundColor(.black)
        }
    }
}
</code></pre>
<p>在 <code>toolbar</code> 的闭包中，我们创建了一个 <code>ToolbarItem</code> 对象，其位置设置为 <code>.navigationBarLeading</code>。 这告诉 iOS 将按钮放在导航栏的前沿。</p>
<p>要让程式产生有效果，更新 <code>RestaurantDetailView</code> 如下：</p>
<pre><code class="lang-swift"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">RestaurantDetailView</span>: <span class="hljs-title">View</span> </span>{
    @<span class="hljs-type">Environment</span>(\.dismiss) <span class="hljs-keyword">var</span> dismiss

    <span class="hljs-keyword">var</span> restaurant: <span class="hljs-type">Restaurant</span>

    <span class="hljs-keyword">var</span> body: some <span class="hljs-type">View</span> {
        <span class="hljs-type">VStack</span> {
            <span class="hljs-type">Image</span>(restaurant.image)
                .resizable()
                .aspectRatio(contentMode: .fit)

            <span class="hljs-type">Text</span>(restaurant.name)
                .font(.system(.title, design: .rounded))
                .fontWeight(.black)

            <span class="hljs-type">Spacer</span>()
        }

        .navigationBarBackButtonHidden(<span class="hljs-built_in">true</span>)
        .toolbar {
            <span class="hljs-type">ToolbarItem</span>(placement: .navigationBarLeading) {
                <span class="hljs-type">Button</span> {
                    dismiss()
                } label: {
                    <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;<span class="hljs-subst">\(Image(systemName: &quot;chevron.<span class="hljs-keyword">left</span>&quot;)</span>) <span class="hljs-subst">\(restaurant.name)</span>&quot;</span>)
                        .foregroundColor(.black)
                }

            }
        }
    }
}
</code></pre>
<p>SwiftUI 内建的环境值很广泛。要解除目前视图，并返回至前一个视图。我们取得  <code>.dismiss</code> 环境值，然后调用 <code>dismiss()</code> 函数。请注意 <code>.dismiss</code> 是 iOS 15（或以上）新加入的环境值，如果你的 App 要支持比较旧的iOS 版本，你可以使用另一个环境值（即 <code>.presentationMode</code>）：</p>
<pre><code class="lang-swift">@<span class="hljs-type">Environment</span>(\.presentationMode) <span class="hljs-keyword">var</span> presentationMode
</code></pre>
<p>之后，你可以利用以下代码调用<code>presentationMode</code> 的 <code>dismiss()</code> 函数：</p>
<pre><code class="lang-swift">presentationMode.wrappedValue.dismiss()
</code></pre>
<p>你在预览画布再测试 App，并选取其中一家餐厅，你会见到一个带有餐厅名的返回按钮。点击返回按钮，视图将导览回主画面。</p>
<h2 id="%E4%BD%9C%E6%A5%AD">作业</h2>
<p>为了确认你理解如何建立导览UI，这里有一个作业。首先，至下列网址下载起始专案： </p>
<p> <a href="https://www.appcoda.com/resources/swiftui4/SwiftUINavigationStarter.zip" target="_blank">https://www.appcoda.com/resources/swiftui4/SwiftUINavigationStarter.zip</a>。开启专案后，你将看到一个显示文章清单的范例App。</p>
<p>这个专案与你之前建立的专案非常类似，主要的差异是 <code>Article.swift</code> 的导入。这个档案储存了 <code>articles</code> 数组，而该数组附有一些范例资料。如果你仔细检视 <code>Article</code> 结构，它现在有一个用于储存完整文章的 <code>content</code> 属性。</p>
<p>你的任务是将清单嵌入导览视图，并建立细节视图。当使用者点击内容视图中其中一篇文章时，它将导览至显示完整文章的细节视图，如图 11.10 所示。我将在下一节中与你讨论解决方案，但请你尽力找出自己的解决方案。</p>
<figure id="fig11.10"><img src="images/navigation/swiftui-navigation-10.jpg" alt="图11.10.　为阅读 App 建立导览 UI"><figcaption>图11.10.　为阅读 App 建立导览 UI</figcaption></figure>
<h3 id="%E5%BB%BA%E7%AB%8B%E7%B4%B0%E7%AF%80%E8%A6%96%E5%9C%96">建立细节视图</h3>
<p>你完成作业了吗？细节视图比我们之前建立的视图更复杂，我们来看看如何建立它。</p>
<p>为了让代码更易编写，我们将为它建立一个单独的档案，而不是在 ContentView.swift 档中建立细节视图。在专案导览器中，右键点击 <code>SwiftUINavigation</code> 资料夹，选择“New File...”，接着选取“SwiftUI View”模板，并将档案命名为“ArticleDetailView.swift”。</p>
<p>由于细节视图将显示文章的详细资讯，我们需要这个属性来让调用者传送文章。因此，在 <code>ArticleDetailView</code> 中声明一个 <code>article</code> 属性： </p>
<pre><code class="lang-swift"><span class="hljs-keyword">var</span> article: <span class="hljs-type">Article</span>
</code></pre>
<p>接着，更新 <code>body</code> 如下，以布局细节视图： </p>
<pre><code class="lang-swift"><span class="hljs-keyword">var</span> body: some <span class="hljs-type">View</span> {
    <span class="hljs-type">ScrollView</span> {
        <span class="hljs-type">VStack</span>(alignment: .leading) {
            <span class="hljs-type">Image</span>(article.image)
                .resizable()
                .aspectRatio(contentMode: .fit)

            <span class="hljs-type">Group</span> {
                <span class="hljs-type">Text</span>(article.title)
                    .font(.system(.title, design: .rounded))
                    .fontWeight(.black)
                    .lineLimit(<span class="hljs-number">3</span>)

                <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;By <span class="hljs-subst">\(article.author)</span>&quot;</span>.uppercased())
                    .font(.subheadline)
                    .foregroundColor(.secondary)
            }
            .padding(.bottom, <span class="hljs-number">0</span>)
            .padding(.horizontal)

            <span class="hljs-type">Text</span>(article.content)
                .font(.body)
                .padding()
                .lineLimit(<span class="hljs-number">1000</span>)
                .multilineTextAlignment(.leading)
        }
    }
}
</code></pre>
<p>我们使用一个 <code>ScrollView</code> 来包裹所有的视图，以启用可滚动的内容。我不会逐行说明代码，我相信你应该了解 <code>Text</code>、<code>Image</code> 与 <code>VStack</code> 的运作方式，不过我想强调的修饰器是 <code>Group</code>，这个修饰器可以让你将多个视图群组在一起，并使用某个设定。在上列的代码中，我们需要对两个 <code>Text</code> 视图使用特定的间距设定。为了避免代码重复，我们将两个视图群组在一起，并使用间距。</p>
<p>现在，我们已经完成了细节视图的布局，但是你应该会在 Xcode 内看到一个错误，指出有<code>ArticleDetailView_Previews</code> 的问题。而预览无法正常运作，是因为我们在 <code>ArticleDetailView</code> 中加入了article 属性，因此你需要在预览中传送一个范例文章。更新 <code>ArticleDetail View_Previews</code>来修正错误，如下所示： </p>
<pre><code class="lang-swift"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ArticleDetailView_Previews</span>: <span class="hljs-title">PreviewProvider</span> </span>{
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">var</span> previews: some <span class="hljs-type">View</span> {
        <span class="hljs-type">ArticleDetailView</span>(article: articles[<span class="hljs-number">0</span>])
    }
}
</code></pre>
<p>这里，我们只选择 <code>articles</code> 数组中的第一篇文章来预览。如果想要预览其他文章，你可以将其更改为其他值。当你变更后，预览画布应会正确渲染细节视图，如图 11.11 所示。</p>
<figure id="fig11.11"><img src="images/navigation/swiftui-navigation-11.png" alt="图 11.11.　用于显示文章的细节视图"><figcaption>图 11.11.　用于显示文章的细节视图</figcaption></figure>
<p>我们再多尝试一件事。由于这个视图将嵌入至 <code>NavigationView</code>中，因此你可以修改预览代码，来预览它在预览介面的外观： </p>
<pre><code class="lang-swift"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ArticleDetailView_Previews</span>: <span class="hljs-title">PreviewProvider</span> </span>{
    <span class="hljs-keyword">static</span> <span class="hljs-keyword">var</span> previews: some <span class="hljs-type">View</span> {
        <span class="hljs-type">NavigationStack</span> {
            <span class="hljs-type">ArticleDetailView</span>(article: articles[<span class="hljs-number">0</span>])

            .navigationTitle(<span class="hljs-string">&quot;Article&quot;</span>)
        }
    }
}
</code></pre>
<p>透过更新程式后，你应该在预览画布中看到一个空白的导览列。</p>
<p>现在我们已经完成了细节视图的布局，是时候该回到 <code>ContentView.swift</code> 来实现导览， 更新 <code>ContentView</code> 结构如下： </p>
<pre><code class="lang-swift"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ContentView</span>: <span class="hljs-title">View</span> </span>{

    <span class="hljs-keyword">var</span> body: some <span class="hljs-type">View</span> {

        <span class="hljs-type">NavigationStack</span> {
            <span class="hljs-type">List</span>(articles) { article <span class="hljs-keyword">in</span>
                <span class="hljs-type">NavigationLink</span>(destination: <span class="hljs-type">ArticleDetailView</span>(article: article)) {
                    <span class="hljs-type">ArticleRow</span>(article: article)
                }

                .listRowSeparator(.hidden)
            }
            .listStyle(.plain)

            .navigationTitle(<span class="hljs-string">&quot;Your Reading&quot;</span>)
        }

    }
}
</code></pre>
<p>在上列的代码中，我们将 <code>List</code> 视图嵌入至 <code>NavigationStack</code> 中， 并对每一列应用 <code>NavigationLink</code>。导览连结的目的地设定为我们刚才建立的细节视图。在预览中，你应该可透过点击“播放”（Play ）按钮来测试 App，并在选择文章后，导览至细节视图。</p>
<h3 id="%E7%A7%BB%E9%99%A4%E6%8F%AD%E7%A4%BA%E6%8C%87%E7%A4%BA%E5%99%A8">移除揭示指示器</h3>
<p>这个 App 运作得很完美，但是有两个问题你可能想要微调。首先是内容视图中的揭示指示器（disclosure indicator ），这里显示揭示指示器有点奇怪，我们可以禁用它吗？第二个问题是，在细节视图中精选图片的上方出现空白区域。我们来逐一讨论这些问题。</p>
<figure id="fig11.12"><img src="images/navigation/swiftui-navigation-12.jpg" alt="图 11.12.　目前设计中的两个问题"><figcaption>图 11.12.　目前设计中的两个问题</figcaption></figure>
<p>SwiftUI 并没有为开发者提供禁用或隐藏揭示指示器的选项。为了解决这个问题，我们不直接将 <code>NavigationLink</code> 应用于文章列，而是建立一个具有两层的 <code>ZStack</code>。现在更新 <code>ContentView</code> 的 <code>NavigationView</code> 如下： </p>
<pre><code class="lang-swift"><span class="hljs-type">NavigationStack</span> {
    <span class="hljs-type">List</span>(articles) { article <span class="hljs-keyword">in</span>
        <span class="hljs-type">ZStack</span> {
            <span class="hljs-type">ArticleRow</span>(article: article)

            <span class="hljs-type">NavigationLink</span>(destination: <span class="hljs-type">ArticleDetailView</span>(article: article)) {
                <span class="hljs-type">EmptyView</span>()
            }
            .opacity(<span class="hljs-number">0</span>)

            .listRowSeparator(.hidden)
        }
    }
    .listStyle(.plain)

    .navigationTitle(<span class="hljs-string">&quot;Your Reading&quot;</span>)
}
</code></pre>
<p>下层是文章列，上层则是空视图。<code>NavigationLink</code> 现在应用于空视图，以避免 iOS 渲染揭示按钮。当你变更后，揭示指示器就会消失，但你仍然可以导览至细节视图。</p>
<p>现在，我们来看第二个问题的根本原因。</p>
<p>切换到 <code>ArticleDetailView.swift</code>，在设计细节视图时，我没有提到这个问题，但实际上从预览中，你应该会发现这个问题，如图 11.13 所示。</p>
<figure id="fig11.13"><img src="images/navigation/swiftui-navigation-13.png" alt="图 11.13　标头中的空白区域"><figcaption>图 11.13　标头中的空白区域</figcaption></figure>
<p>图片上方会出现空白区域的原因是导览列的缘故。这个空白区域实际上是一个带有空白标题的大尺寸导览列，当App 从内容视图导览至细节视图时，导览列会变成标准尺寸列。因此，要修复这个问题，我们需要做的是明确指定使用标准尺寸导览列。</p>
<p>在 <code>ScrollView</code> 的括号后，插入下列这行代码： </p>
<pre><code class="lang-swift">.navigationBarTitleDisplayMode(.inline)
</code></pre>
<p>透过将导览列设定为 <code>inline</code> 模式后，空白区域将被最小化，现在你可回到 <code>ContentView.swift</code> 来再次测试App，细节视图现在看起来好多了。</p>
<h3 id="%E5%B8%B6%E6%9C%89%E5%AE%A2%E8%A3%BD%E5%8C%96%E3%80%8C%E8%BF%94%E5%9B%9E%E3%80%8D%E6%8C%89%E9%88%95%E7%9A%84%E7%B2%BE%E7%B7%BB-ui">带有客制化“返回”按钮的精致 UI</h3>
<p>虽然你可使用内建的属性来自订“返回”按钮指示器图片，有时你可能想要建立一个客制化“返回”按钮来导览回内容视图。问题是如何透过编写代码来完成呢？ </p>
<p>在最后一个小节中，我要介绍如何透过隐藏导览列及建立自己的“返回”按钮，来建立一个更精致的细节视图。首先，我们看一下如图 11.14 所示的最终设计，看起来不错吧？ </p>
<figure id="fig11.14"><img src="images/navigation/swiftui-navigation-14.png" alt="图 11.14.　经修订的细节视图"><figcaption>图 11.14.　经修订的细节视图</figcaption></figure>
<p>要布局这个画面，我们必须要解决两个问题： </p>
<ol>
<li>如何将滚动视图延伸到画面顶部？ </li>
<li>如何建立一个客制化“返回”按钮，并编写代码来触发导览？ </li>
</ol>
<p>iOS 有一个“安全区域”（safe area ）的观念，用于辅助视图的布局。安全区域可帮你将视图放置于介面的可见部分，例如：安全区域防止视图隐藏了状态列。若是你的 UI 导入了导览列，则会遮挡导览列。</p>
<figure id="fig11.15"><img src="images/navigation/swiftui-navigation-15.jpg" alt="![图 11.15　安全区域](images/navigation/swiftui-navigation-15.jpg)"><figcaption>![图 11.15　安全区域](images/navigation/swiftui-navigation-15.jpg)</figcaption></figure>
<p>要放置超出安全区域的内容，你可以使用名为 <code>ignoresSafeArea</code> 修饰器。对于我们的专案，由于我们想要滚动视图超出安全区域的顶部边缘，则可编写修饰器如下： </p>
<pre><code class="lang-swift">.ignoresSafeArea(.all, edges: .top)
</code></pre>
<p>这个修饰器接收其他值，如 <code>.bottom</code> 与 <code>.leading</code>。如果你想要忽略整个安全区域，则可以直接使用<code>.ignoresSafeArea()</code>。透过将这个修饰器加到 <code>ScrollView</code>，我们可以隐藏导览列，并实现一个视觉上赏心悦目的细节视图。</p>
<figure id="fig11.16"><img src="images/navigation/swiftui-navigation-16.png" alt="图 11.16.　应用这些修饰器至滚动视图"><figcaption>图 11.16.　应用这些修饰器至滚动视图</figcaption></figure>
<p>现在谈到关于建立自己的“返回”按钮的第二个问题，这个问题比第一个问题更棘手。下面是我们要实现的内容： </p>
<ol>
<li>隐藏原来的“返回”按钮。</li>
<li>建立一个一般的按钮，然后将其指定为导览列的左侧按钮。</li>
</ol>
<p>为了隐藏“返回”按钮，SwiftUI 提供一个名为 <code>navigationBarBackButtonHidden</code> 的修饰器。你只需将其值设定为 <code>true</code>，即可隐藏“返回”按钮： </p>
<pre><code class="lang-swift">.navigationBarBackButtonHidden(<span class="hljs-built_in">true</span>)
</code></pre>
<p>当隐藏“返回”按钮后，你可以使用自己的按钮来替代它。<code>toolbar</code> 修饰器允许你配置导航栏项目。 在闭包中，我们使用<code>ToolbarItem</code>自订后退按钮，并将该按钮指定为导航栏的左按钮。 以下是相关代码：</p>
<pre><code class="lang-swift">.toolbar {
    <span class="hljs-type">ToolbarItem</span>(placement: .navigationBarLeading) {
        <span class="hljs-type">Button</span>(action: {
            <span class="hljs-comment">// 导览至前一个画面</span>
        }) {
            <span class="hljs-type">Image</span>(systemName: <span class="hljs-string">&quot;chevron.left.circle.fill&quot;</span>)
                .font(.largeTitle)
                .foregroundColor(.white)
        }
    }
}
</code></pre>
<p>你可以将上述的修饰器加到 <code>ScrollView</code>。当修改生效后，你应该会在预览画布中看到我们自己的客制化“返回”按钮，如图 11.17 所示。</p>
<figure id="fig11.17"><img src="images/navigation/swiftui-navigation-17.png" alt="图 11.17.　建立我们自己的“返回”按钮"><figcaption>图 11.17.　建立我们自己的“返回”按钮</figcaption></figure>
<p>你可能发现按钮的 <code>action</code> 闭包被留空。“返回”按钮已经布局得不错了，但问题是它不能运作。</p>
<p>原来的“返回”按钮是由 <code>NavigationView</code> 渲染，可以自动导览回前一个画面。问题来了，我们该如何编写代码来触发这个操作呢？感谢 SwiftUI 框架所内建的环境值（environment value ），你可以引用一个名为<code>dismiss</code> 环境绑定（environment binding ），来导览至前一个画面。</p>
<p>现在，在 <code>ArticleDetailView</code> 声明一个 <code>dismiss</code> 变量来取得环境值： </p>
<pre><code class="lang-swift">@<span class="hljs-type">Environment</span>(\.dismiss) <span class="hljs-keyword">var</span> dismiss
</code></pre>
<p>接下来，在我们的客制化“返回”按钮的 <code>action</code> 中，插入下列这行代码： </p>
<pre><code class="lang-swift">dismiss()
</code></pre>
<p>这里，我们调用 <code>dismiss</code> 方法，以在点击“返回”按钮时解除细节视图。现在，你可以执行 App 并再次测试它，你应该能够在内容视图与细节视图之间进行导览。</p>
<h3 id="%E6%9C%AC%E7%AB%A0%E5%B0%8F%E7%B5%90">本章小结</h3>
<p>导览 UI 在行动 App 中非常常见，理解我在本章所介绍的内容非常重要。如果你完全理解了内容，即使资料是静态的，你也可以建立一个基于内容的简单 App。</p>
<p>在本章所准备的范例档中，有完整的专案可供下载： </p>
<ul>
<li>第一个专案的专案范例 (<a href="https://www.appcoda.com/resources/swiftui4/SwiftUINavigationList.zip" target="_blank">https://www.appcoda.com/resources/swiftui4/SwiftUINavigationList.zip</a>)</li>
<li>第二个专案的专案范例(<a href="https://www.appcoda.com/resources/swiftui4/SwiftUINavigation.zip" target="_blank">https://www.appcoda.com/resources/swiftui4/SwiftUINavigation.zip</a>)</li>
</ul>
<p>要进一步学习导览视图，你也可以参考下列 Apple 所提供的文件： </p>
<ul>
<li><a href="https://developer.apple.com/tutorials/swiftui/building-lists-and-navigation" target="_blank">https://developer.apple.com/tutorials/swiftui/building-lists-and-navigation</a></li>
<li><a href="https://developer.apple.com/documentation/swiftui/navigationstack" target="_blank">https://developer.apple.com/documentation/swiftui/navigationstack</a></li>
</ul>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="./swiftui-list.html" class="navigation navigation-prev " aria-label="Previous page: 动态列表、 ForEach 与 Identifiable 的使用方法"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="./swiftui-modal.html" class="navigation navigation-next " aria-label="Next page: 强制回应视图、浮动按钮与提示的实现"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="gitbook/app.js"></script>

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":"white","family":"serif","size":3},"image-captions":{"caption":"_CAPTION_","variable_name":"_pictures"}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
