<!DOCTYPE HTML>
<html lang="zh-tw" >
    
    <head>
        
        <meta charset=utf-8"UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=11; IE=10; IE=9; IE=8; IE=7; IE=EDGE" />
        <title>使用新的 NavigationStack 视图构建资料导向的导航 | 精通 SwiftUI - iOS 16 版</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.0.1">
        <meta name="author" content="Simon Ng">
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    
    <link rel="prev" href="./swiftui-anylayout.html" />
    

        
    </head>
    <body>
        
        
    <link rel="stylesheet" href="gitbook/style.css">
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-image-captions/image-captions.css">
        
    
    
        <link rel="stylesheet" href="././styles/website.css">
    

        
    <div class="book" data-level="46" data-basepath="." data-revision="Thu Dec 01 2022 17:36:55 GMT+0800 (HKT)">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="输入并搜寻" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
            
            <li>
                <a href="https://www.appcoda.com.tw" target="blank" class="custom-link">Made by AppCoda</a>
            </li>
        
            
            <li>
                <a href="https://www.appcoda.com.tw/contact" target="blank" class="custom-link">Contact us / Support</a>
            </li>
        
            
            <li>
                <a href="http://twitter.com/share?text=Mastering%20SwiftUI%20via%20@appcodamobile&amp;url=https://www.appcoda.com.tw/swiftui/&amp;hashtags=swiftlang" target="blank" class="custom-link">Tweet this book</a>
            </li>
        
        

        
        <li class="divider"></li>
        

        
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="./index.html">
                        <i class="fa fa-check"></i>
                        
                        序言
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="swiftui-basics.html">
            
                
                    <a href="./swiftui-basics.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        SwiftUI 介绍
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="swiftui-text.html">
            
                
                    <a href="./swiftui-text.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        SwiftUI 入门 - 文字的处理
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3" data-path="swiftui-images.html">
            
                
                    <a href="./swiftui-images.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        图片的处理
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4" data-path="swiftui-stacks.html">
            
                
                    <a href="./swiftui-stacks.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        以堆叠布局使用者介面
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5" data-path="swiftui-scrollview.html">
            
                
                    <a href="./swiftui-scrollview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        ScrollView 与 Carousel UI 的建立
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="6" data-path="swiftui-buttons.html">
            
                
                    <a href="./swiftui-buttons.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        SwiftUI 按钮与渐层
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="7" data-path="swiftui-state.html">
            
                
                    <a href="./swiftui-state.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        状态(State)与绑定(Binding)
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="8" data-path="swiftui-path-shape.html">
            
                
                    <a href="./swiftui-path-shape.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        实作路径(Path)与形状(Shape)来画线与圆饼图
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="9" data-path="swiftui-animation.html">
            
                
                    <a href="./swiftui-animation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                        基础动画与转场
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="10" data-path="swiftui-list.html">
            
                
                    <a href="./swiftui-list.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.</b>
                        
                        动态列表、 ForEach 与 Identifiable 的使用方法
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="11" data-path="swiftui-navigation.html">
            
                
                    <a href="./swiftui-navigation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.</b>
                        
                        导览UI与导览列客制化运用
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="12" data-path="swiftui-modal.html">
            
                
                    <a href="./swiftui-modal.html">
                        <i class="fa fa-check"></i>
                        
                            <b>12.</b>
                        
                        强制回应视图、浮动按钮与提示的实作
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="13" data-path="swiftui-form.html">
            
                
                    <a href="./swiftui-form.html">
                        <i class="fa fa-check"></i>
                        
                            <b>13.</b>
                        
                        以选取器(Picker)、开关(Toggle)与步进器(Stepper)来建立一个表单
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="14" data-path="swiftui-form-data.html">
            
                
                    <a href="./swiftui-form-data.html">
                        <i class="fa fa-check"></i>
                        
                            <b>14.</b>
                        
                        使用 Combine 与 Environment 物件进行资料分享
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="15" data-path="swiftui-form-registration.html">
            
                
                    <a href="./swiftui-form-registration.html">
                        <i class="fa fa-check"></i>
                        
                            <b>15.</b>
                        
                        以 Combine 与 视图模型建立一个注册表单
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="16" data-path="swiftui-actionsheet-context.html">
            
                
                    <a href="./swiftui-actionsheet-context.html">
                        <i class="fa fa-check"></i>
                        
                            <b>16.</b>
                        
                        滑动删除、内容选单与动作列表
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="17" data-path="swiftui-gestures.html">
            
                
                    <a href="./swiftui-gestures.html">
                        <i class="fa fa-check"></i>
                        
                            <b>17.</b>
                        
                        认识手势（Gestures）
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="18" data-path="swiftui-bottom-sheet.html">
            
                
                    <a href="./swiftui-bottom-sheet.html">
                        <i class="fa fa-check"></i>
                        
                            <b>18.</b>
                        
                        以SwiftUI 手势与 GeometryReader 建立一个底部展开式页面
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="19" data-path="swiftui-trip-tinder.html">
            
                
                    <a href="./swiftui-trip-tinder.html">
                        <i class="fa fa-check"></i>
                        
                            <b>19.</b>
                        
                        使用手势与动画建立 Tinder 风格的 UI
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="20" data-path="swiftui-advanced-animations.html">
            
                
                    <a href="./swiftui-advanced-animations.html">
                        <i class="fa fa-check"></i>
                        
                            <b>20.</b>
                        
                        建立像 Apple Wallet App 的动画和转场效果
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="21" data-path="swiftui-json.html">
            
                
                    <a href="./swiftui-json.html">
                        <i class="fa fa-check"></i>
                        
                            <b>21.</b>
                        
                        JSON、滑杆的运用与资料过滤
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="22" data-path="swiftui-core-data.html">
            
                
                    <a href="./swiftui-core-data.html">
                        <i class="fa fa-check"></i>
                        
                            <b>22.</b>
                        
                        如何使用 Core Data 建立 ToDo App
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="23" data-path="swiftui-uikit.html">
            
                
                    <a href="./swiftui-uikit.html">
                        <i class="fa fa-check"></i>
                        
                            <b>23.</b>
                        
                        利用 UIViewRepresentable 整合UIKit 组件
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="24" data-path="swiftui-searchbar.html">
            
                
                    <a href="./swiftui-searchbar.html">
                        <i class="fa fa-check"></i>
                        
                            <b>24.</b>
                        
                        建立搜寻栏视图并使用自订绑定（Custom Binding）
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="25" data-path="swiftui-real-world-app.html">
            
                
                    <a href="./swiftui-real-world-app.html">
                        <i class="fa fa-check"></i>
                        
                            <b>25.</b>
                        
                        把所学应用出来！构建个人理财App
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="26" data-path="swiftui-appstoreanimation.html">
            
                
                    <a href="./swiftui-appstoreanimation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>26.</b>
                        
                        创建类似App Store使用的动画视图转换
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="27" data-path="swiftui-carousel.html">
            
                
                    <a href="./swiftui-carousel.html">
                        <i class="fa fa-check"></i>
                        
                            <b>27.</b>
                        
                        如何建立图像轮播（Image Carousel）
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="28" data-path="swiftui-expandable-list.html">
            
                
                    <a href="./swiftui-expandable-list.html">
                        <i class="fa fa-check"></i>
                        
                            <b>28.</b>
                        
                        如何建立展开式列表视图和大纲视图
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="29" data-path="swiftui-gridlayout.html">
            
                
                    <a href="./swiftui-gridlayout.html">
                        <i class="fa fa-check"></i>
                        
                            <b>29.</b>
                        
                        使用 LazyVGrid 和 LazyHGrid 构建集合视图
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="30" data-path="swiftui-progress-ring.html">
            
                
                    <a href="./swiftui-progress-ring.html">
                        <i class="fa fa-check"></i>
                        
                            <b>30.</b>
                        
                        使用 Shape 和 Animatable 开发带动画的环形进度条
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="31" data-path="swiftui-library.html">
            
                
                    <a href="./swiftui-library.html">
                        <i class="fa fa-check"></i>
                        
                            <b>31.</b>
                        
                        如何使用 AnimatableModifier 和 LibraryContentProvider
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="32" data-path="swiftui-texteditor.html">
            
                
                    <a href="./swiftui-texteditor.html">
                        <i class="fa fa-check"></i>
                        
                            <b>32.</b>
                        
                        使用 TextEditor 支援多行文字输入
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="33" data-path="swiftui-matchedgeometry.html">
            
                
                    <a href="./swiftui-matchedgeometry.html">
                        <i class="fa fa-check"></i>
                        
                            <b>33.</b>
                        
                        使用 matchedGeometryEffect为 App 建立绚丽的视图动画
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="34" data-path="swiftui-grid-animation.html">
            
                
                    <a href="./swiftui-grid-animation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>34.</b>
                        
                        ScrollViewReader 和网格动画
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="35" data-path="swiftui-tabview.html">
            
                
                    <a href="./swiftui-tabview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>35.</b>
                        
                        标签视图的运用与自订标签列
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="36" data-path="swiftui-asyncimage.html">
            
                
                    <a href="./swiftui-asyncimage.html">
                        <i class="fa fa-check"></i>
                        
                            <b>36.</b>
                        
                        利用 AsyncImage 非同步加载和显示图像
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="37" data-path="swiftui-searchable.html">
            
                
                    <a href="./swiftui-searchable.html">
                        <i class="fa fa-check"></i>
                        
                            <b>37.</b>
                        
                        利用 Searchable 建立搜寻栏
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="38" data-path="swiftui-charts.html">
            
                
                    <a href="./swiftui-charts.html">
                        <i class="fa fa-check"></i>
                        
                            <b>38.</b>
                        
                        利用 Charts 框架建立图表
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="39" data-path="swiftui-live-text.html">
            
                
                    <a href="./swiftui-live-text.html">
                        <i class="fa fa-check"></i>
                        
                            <b>39.</b>
                        
                        利用 Live Text API 从图片中撷取文本
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="40" data-path="swiftui-sharelink.html">
            
                
                    <a href="./swiftui-sharelink.html">
                        <i class="fa fa-check"></i>
                        
                            <b>40.</b>
                        
                        透过 ShareLink 来分享文本和图像等资料
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="41" data-path="swiftui-imagerenderer.html">
            
                
                    <a href="./swiftui-imagerenderer.html">
                        <i class="fa fa-check"></i>
                        
                            <b>41.</b>
                        
                        利用 ImageRenderer API 轻松把 SwiftUI 视图转换为图像
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="42" data-path="swiftui-pdf-doc.html">
            
                
                    <a href="./swiftui-pdf-doc.html">
                        <i class="fa fa-check"></i>
                        
                            <b>42.</b>
                        
                        如何把 SwiftUI 视图转换为 PDF 文件
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="43" data-path="swiftui-gauge.html">
            
                
                    <a href="./swiftui-gauge.html">
                        <i class="fa fa-check"></i>
                        
                            <b>43.</b>
                        
                        使用 Gauge 视图显示进度并创建速度计
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="44" data-path="swiftui-grid.html">
            
                
                    <a href="./swiftui-grid.html">
                        <i class="fa fa-check"></i>
                        
                            <b>44.</b>
                        
                        使用Grid API 创建网格布局
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="45" data-path="swiftui-anylayout.html">
            
                
                    <a href="./swiftui-anylayout.html">
                        <i class="fa fa-check"></i>
                        
                            <b>45.</b>
                        
                        利用 AnyLayout 切换 UI 布局
                    </a>
                
            
            
        </li>
    
        <li class="chapter active" data-level="46" data-path="swiftui-navigationstack.html">
            
                
                    <a href="./swiftui-navigationstack.html">
                        <i class="fa fa-check"></i>
                        
                            <b>46.</b>
                        
                        使用新的 NavigationStack 视图构建资料导向的导航
                    </a>
                
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                本书使用 GitBook 释出
            </a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="目录"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="搜寻"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="字型设定"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">衬线体</button>
        <button type="button" data-font="1" class="button">无衬线体</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">白色</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">棕褐色</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">夜间</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="分享"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    分享到 Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    分享到 Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    分享到 Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    分享到 Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    分享到 Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="./" >精通 SwiftUI - iOS 16 版</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="%E7%AC%AC-46-%E7%AB%A0-br-%E4%BD%BF%E7%94%A8%E6%96%B0%E7%9A%84-navigationstack-%E8%A6%96%E5%9C%96%E6%A7%8B%E5%BB%BA%E8%B3%87%E6%96%99%E5%B0%8E%E5%90%91%E7%9A%84%E5%B0%8E%E8%88%AA">第 46 章<br>使用新的 NavigationStack 视图构建资料导向的导航</h1>
<p>在 iOS 开发中，导览视图 (Navigation View) 绝对是我们最常用的组件。在 SwiftUI 刚推出的时侯，就已经有一个 <code>NavigationView</code> 视图，让开发者可以构建基于导览的使用者界面。随着 iOS 16 的发布，Apple 弃用了旧的导览视图，并引入了一个新视图 <code>NavigationStack</code> 来呈现堆叠视图。更重要的是，开发者现在可以利用这个新视图来构建资料导向 (data driven) 的导航。</p>
<h3 id="%E8%88%8A%E7%9A%84-navigation-views-%E7%9A%84%E6%93%8D%E4%BD%9C">旧的 Navigation Views 的操作</h3>
<p>在 iOS 16 之前，我们会用 <code>NavigationView</code> 和 <code>NavigationLink</code> 如此构建导览介面：</p>
<pre><code class="lang-swift"><span class="hljs-type">NavigationView</span> {
    <span class="hljs-type">NavigationLink</span> {
        <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;Destination&quot;</span>)
    } label: {
        <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;Tap me&quot;</span>)
    }
}
</code></pre>
<p>以上代码会构建出一个基本的导览介面，当中有一个 <em>Tap me</em> 按钮。当我们点击按钮，App 就会导览到下一级，来显示目标视图。</p>
<figure id="fig46.1"><img src="images/navigationstack/swiftui-navigationstack-1.png" alt="图 46.1. 基本的导览介面"><figcaption>图 46.1. 基本的导览介面</figcaption></figure>
<h3 id="%E4%BD%BF%E7%94%A8-navigationstack">使用 NavigationStack</h3>
<p>从 iOS 16 开始，我们可以用新的 <code>NavigationStack</code> 来取代 <code>NavigationView</code>。我们可以完全保留 <code>NavigationLink</code>，都会得到相同的结果。</p>
<pre><code class="lang-swift"><span class="hljs-type">NavigationStack</span> {
    <span class="hljs-type">NavigationLink</span> {
        <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;Destination&quot;</span>)
    } label: {
        <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;Tap me&quot;</span>)
    }
}
</code></pre>
<p>我们也可以这样编写代码：</p>
<pre><code class="lang-swift"><span class="hljs-type">NavigationStack</span> {
    <span class="hljs-type">NavigationLink</span>(<span class="hljs-string">&quot;Tap me&quot;</span>) {
        <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;Destination&quot;</span>)
    }
}
</code></pre>
<p>要显示一个资料项目的列表，通常我们会使用导览视图来构建一个 master-detail flow。来看看以下的范例：</p>
<pre><code class="lang-swift"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ContentView</span>: <span class="hljs-title">View</span> </span>{
    private <span class="hljs-keyword">var</span> bgColors: [<span class="hljs-type">Color</span>] = [ .indigo, .yellow, .green, .orange, .brown ]

    <span class="hljs-keyword">var</span> body: some <span class="hljs-type">View</span> {

        <span class="hljs-type">NavigationStack</span> {
            <span class="hljs-type">List</span>(bgColors, id: \.<span class="hljs-keyword">self</span>) { bgColor <span class="hljs-keyword">in</span>
                <span class="hljs-type">NavigationLink</span> {
                    bgColor
                        .frame(maxWidth: .infinity, maxHeight: .infinity)
                } label: {
                    <span class="hljs-type">Text</span>(bgColor.description)
                }

            }
            .listStyle(.plain)

            .navigationTitle(<span class="hljs-string">&quot;Color&quot;</span>)
        }

    }
}
</code></pre>
<p>以上的代码会建立一个导览视图，来显示构建一个 master-detail 流程。当使用者选择了一个项目，App 就会导览到 detail 视图，并显示 color 视图。</p>
<figure id="fig46.2"><img src="images/navigationstack/swiftui-navigationstack-2.png" alt="图 46.2. 一个 master-detail 导览视图"><figcaption>图 46.2. 一个 master-detail 导览视图</figcaption></figure>
<h3 id="%E5%BB%BA%E5%9F%BA%E6%96%BC%E6%95%B8%E5%80%BC%E7%9A%84-navigation-links">建基于数值的 Navigation Links</h3>
<p><code>NavigationStack</code> 引入了一个新修饰符 <code>navigationDestination</code>，用来把目标视图与呈现的资料型别连系。我们可以这样重新编写上一节的代码：</p>
<pre><code class="lang-swift"><span class="hljs-type">NavigationStack</span> {
    <span class="hljs-type">List</span>(bgColors, id: \.<span class="hljs-keyword">self</span>) { bgColor <span class="hljs-keyword">in</span>

        <span class="hljs-type">NavigationLink</span>(value: bgColor) {
            <span class="hljs-type">Text</span>(bgColor.description)
        }

    }
    .listStyle(.plain)

    .navigationDestination(<span class="hljs-keyword">for</span>: <span class="hljs-type">Color</span>.<span class="hljs-keyword">self</span>) { color <span class="hljs-keyword">in</span>
        color
            .frame(maxWidth: .infinity, maxHeight: .infinity)
    }

    .navigationTitle(<span class="hljs-string">&quot;Color&quot;</span>)
}
</code></pre>
<p>我们还是会使用 <code>NavigationLinks</code> 来显示资料列表，并实作导览功能；不同之处是每个 <code>NavigationLink</code> 都连系着一个数值。更重要的是，我们添加了新的 <code>navigationDestination</code> 修饰符来捕捉数值的变化。当使用者选择特定的 link 时，<code>navigationDestination</code> 修饰符就会显示相应带有 <code>Color</code> 型别资料的目标视图。</p>
<p>如果我们在预览中测试这个 App，你会发现它的操作方式与之前完全相同。但是，内部的实作已经使用了新的 <code>navigationDestination</code> 修饰符。</p>
<h3 id="%E5%A4%9A%E5%80%8B-navigation-destination-%E4%BF%AE%E9%A3%BE%E5%99%A8">多个 Navigation Destination 修饰器</h3>
<p>我们可以定义多于一个 <code>navigationDestination</code> 修饰符，来处理不同型别的 Navigation Link。在之前的范例中，我们只有一个 <code>navigationDestination</code> 修饰符来处理 <code>Color</code> 型别。现在，让我们为 <code>String</code> 型别设置另一组 Navigation Link：</p>
<pre><code class="lang-swift"><span class="hljs-type">List</span>(systemImages, id: \.<span class="hljs-keyword">self</span>) { systemImage <span class="hljs-keyword">in</span>

    <span class="hljs-type">NavigationLink</span>(value: systemImage) {
        <span class="hljs-type">Text</span>(systemImage.description)
    }

}
.listStyle(.plain)
</code></pre>
<p><code>systemImages</code> 变数会储存系统图像名称的数组 (array)。</p>
<pre><code class="lang-swift">private <span class="hljs-keyword">var</span> systemImages: [<span class="hljs-type">String</span>] = [ <span class="hljs-string">&quot;trash&quot;</span>, <span class="hljs-string">&quot;cloud&quot;</span>, <span class="hljs-string">&quot;bolt&quot;</span> ]
</code></pre>
<p>在这个范例中，我们有两个型别的 Navigation Link，一个是 <code>Color</code>，另一个是 <code>String</code> 型别。让我们把另一个 <code>navigationDestination</code> 修饰器嵌入到堆叠中，来处理 <code>String</code> 型别的导览：</p>
<pre><code class="lang-swift">.navigationDestination(<span class="hljs-keyword">for</span>: <span class="hljs-type">String</span>.<span class="hljs-keyword">self</span>) { systemImage <span class="hljs-keyword">in</span>
    <span class="hljs-type">Image</span>(systemName: systemImage)
        .font(.system(size: <span class="hljs-number">100.0</span>))
}
</code></pre>
<p>现在，如果使用者点击其中一个系统图像名称，就会导览到另一个视图，来显示系统图像。</p>
<figure id="fig46.3"><img src="images/navigationstack/swiftui-navigationstack-3.png" alt="图 46.3. Navigation Destination 修饰器"><figcaption>图 46.3. Navigation Destination 修饰器</figcaption></figure>
<h3 id="%E4%BA%86%E8%A7%A3-navigation-%E7%8B%80%E6%85%8B">了解 Navigation 状态</h3>
<p>与旧的 <code>NavigationView</code> 不同，新的 <code>NavigationStack</code> 让我们可以轻松地追踪导览的状态。<code>NavigationStack</code> 视图有另一个 initialization 方法，它有一个 <code>path</code> 参数 (parameter)，就是堆叠导览状态的 binding：</p>
<pre><code class="lang-swift"><span class="hljs-keyword">init</span>(
    path: <span class="hljs-type">Binding</span>&lt;<span class="hljs-type">Data</span>&gt;,
    root: () -&gt; <span class="hljs-type">Root</span>
) <span class="hljs-keyword">where</span> <span class="hljs-type">Data</span> : <span class="hljs-type">MutableCollection</span>, <span class="hljs-type">Data</span> : <span class="hljs-type">RandomAccessCollection</span>, <span class="hljs-type">Data</span> : <span class="hljs-type">RangeReplaceableCollection</span>, <span class="hljs-type">Data</span>.<span class="hljs-type">Element</span> : <span class="hljs-type">Hashable</span>
</code></pre>
<p>如果我们想储存或管理导览状态，可以创建一个状态变数。以下是范例代码：</p>
<pre><code class="lang-swift"><span class="hljs-class"><span class="hljs-keyword">struct</span> <span class="hljs-title">ContentView</span>: <span class="hljs-title">View</span> </span>{
    private <span class="hljs-keyword">var</span> bgColors: [<span class="hljs-type">Color</span>] = [ .indigo, .yellow, .green, .orange, .brown ]

    @<span class="hljs-type">State</span> private <span class="hljs-keyword">var</span> path: [<span class="hljs-type">Color</span>] = []

    <span class="hljs-keyword">var</span> body: some <span class="hljs-type">View</span> {

        <span class="hljs-type">NavigationStack</span>(path: $path) {
            <span class="hljs-type">List</span>(bgColors, id: \.<span class="hljs-keyword">self</span>) { bgColor <span class="hljs-keyword">in</span>

                <span class="hljs-type">NavigationLink</span>(value: bgColor) {
                    <span class="hljs-type">Text</span>(bgColor.description)
                }

            }
            .listStyle(.plain)

            .navigationDestination(<span class="hljs-keyword">for</span>: <span class="hljs-type">Color</span>.<span class="hljs-keyword">self</span>) { color <span class="hljs-keyword">in</span>
                <span class="hljs-type">VStack</span> {
                    <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;<span class="hljs-subst">\(path.<span class="hljs-built_in">count</span>)</span>, <span class="hljs-subst">\(path.description)</span>&quot;</span>)
                        .font(.headline)

                    <span class="hljs-type">HStack</span> {
                        <span class="hljs-type">ForEach</span>(path, id: \.<span class="hljs-keyword">self</span>) { color <span class="hljs-keyword">in</span>
                            color
                                .frame(maxWidth: .infinity, maxHeight: .infinity)
                        }

                    }

                    <span class="hljs-type">List</span>(bgColors, id: \.<span class="hljs-keyword">self</span>) { bgColor <span class="hljs-keyword">in</span>

                        <span class="hljs-type">NavigationLink</span>(value: bgColor) {
                            <span class="hljs-type">Text</span>(bgColor.description)
                        }

                    }
                    .listStyle(.plain)

                }
            }

            .navigationTitle(<span class="hljs-string">&quot;Color&quot;</span>)

        }

    }
}
</code></pre>
<p>这段代码与之前的范例有点相似，我们添加了一个 <code>path</code> 状态变数，它是 <code>Color</code> 的数组，用来储存导览状态。在 <code>NavigationStack</code> 进行 initialization 时，我们会传递它的 binding 来管理堆叠。当导览堆叠的状态发生变化时，<code>path</code> 变数的数值就会被自动更新。</p>
<p>我更改了导览目的地，它会显示使用者选择的颜色，和另一个颜色列表以供使用者选择。</p>
<figure id="fig46.4"><img src="images/navigationstack/swiftui-navigationstack-4.png" alt="图 46.4. 使用 path 变数"><figcaption>图 46.4. 使用 path 变数</figcaption></figure>
<p>在上面的代码中，我们有一行代码来显示 path 的内容：</p>
<pre><code class="lang-swift"><span class="hljs-type">Text</span>(<span class="hljs-string">&quot;<span class="hljs-subst">\(path.<span class="hljs-built_in">count</span>)</span>, <span class="hljs-subst">\(path.description)</span>&quot;</span>)
</code></pre>
<p><code>count</code> 属性 (property) 是指堆叠的 level，而 description 就是当前的颜色。举个例子，我们首先选择颜色 <em>indigo</em>，然后选择 <em>yellow</em>。在这个情况下，<code>count</code> 的数值就应该是 2<em>，</em>代表导览堆叠有 2 个 level。</p>
<p>我们可以利用这个 <code>path</code> 变数，来以编程方式控制堆叠的导览。举个例子，我们可以添加一个按钮，让使用者直接跳转到堆叠的 root level，以下是范例代码：</p>
<pre><code class="lang-swift"><span class="hljs-type">Button</span> {
    path = .<span class="hljs-keyword">init</span>()
} label: {
    <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;Back to Main&quot;</span>)
}
.buttonStyle(.borderedProminent)
.controlSize(.large)
</code></pre>
<p>我们可以重置 <code>path</code> 变数的数值，来指示导览堆叠返回 root level。</p>
<p>大家可能已经知道，我们可以操纵 <code>path</code> 变数的数值，来控制导览堆叠的状态。举个例子，我们可以向 <code>path</code> 变数添加三种颜色，如此一来，当 <code>ContentView</code> 出现时，App 就会自动导览 3 个 level：</p>
<pre><code class="lang-swift"><span class="hljs-type">NavigationStack</span>(path: $path) {
  .
  .
  .
}
.onAppear {
    path.append(.indigo)
    path.append(.yellow)
    path.append(.green)
}
</code></pre>
<p>你可以试着执行 App，就会看到 App 自动导览了 3 层。如此一来，我们就可以以编程方式控制导览状态，并处理 deep linking。</p>
<figure id="fig46.5"><img src="images/navigationstack/swiftui-navigationstack-5.png" alt="图 46.5. App 自动导览了 3 层"><figcaption>图 46.5. App 自动导览了 3 层</figcaption></figure>
<h3 id="%E7%B8%BD%E7%B5%90">总结</h3>
<p>iOS 16 推出的新 <code>NavigationStack</code>，可以让开发者轻松地构建资料导向的导航 UI。如果你的 App 不需要支援旧版本的 iOS，就可以利用这个新元件，来处理 deep linking 和复杂的 user flow。</p>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="./swiftui-anylayout.html" class="navigation navigation-prev navigation-unique" aria-label="Previous page: 利用 AnyLayout 切换 UI 布局"><i class="fa fa-angle-left"></i></a>
        
        
    </div>
</div>

        
<script src="gitbook/app.js"></script>

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":"white","family":"serif","size":3},"image-captions":{"caption":"_CAPTION_","variable_name":"_pictures"}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
