<!DOCTYPE HTML>
<html lang="zh-tw" >
    
    <head>
        
        <meta charset=utf-8"UTF-8">
        <meta http-equiv="X-UA-Compatible" content="IE=11; IE=10; IE=9; IE=8; IE=7; IE=EDGE" />
        <title>强制回应视图、浮动按钮与提示的实现 | 精通 SwiftUI - iOS 16 版</title>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="generator" content="GitBook 2.0.1">
        <meta name="author" content="Simon Ng">
        
        <meta name="HandheldFriendly" content="true"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">
        <meta name="apple-mobile-web-app-capable" content="yes">
        <meta name="apple-mobile-web-app-status-bar-style" content="black">
        <link rel="apple-touch-icon-precomposed" sizes="152x152" href="gitbook/images/apple-touch-icon-precomposed-152.png">
        <link rel="shortcut icon" href="gitbook/images/favicon.ico" type="image/x-icon">
        
    
    
    <link rel="next" href="./swiftui-form.html" />
    
    
    <link rel="prev" href="./swiftui-navigation.html" />
    

        
    </head>
    <body>
        
        
    <link rel="stylesheet" href="gitbook/style.css">
    
        
        <link rel="stylesheet" href="gitbook/plugins/gitbook-plugin-image-captions/image-captions.css">
        
    
    
        <link rel="stylesheet" href="././styles/website.css">
    

        
    <div class="book" data-level="12" data-basepath="." data-revision="Thu Dec 01 2022 17:36:55 GMT+0800 (HKT)">
    

<div class="book-summary">
    <div class="book-search">
        <input type="text" placeholder="输入并搜寻" class="form-control" />
    </div>
    <ul class="summary">
        
        
        
            
            <li>
                <a href="https://www.appcoda.com.tw" target="blank" class="custom-link">Made by AppCoda</a>
            </li>
        
            
            <li>
                <a href="https://www.appcoda.com.tw/contact" target="blank" class="custom-link">Contact us / Support</a>
            </li>
        
            
            <li>
                <a href="http://twitter.com/share?text=Mastering%20SwiftUI%20via%20@appcodamobile&amp;url=https://www.appcoda.com.tw/swiftui/&amp;hashtags=swiftlang" target="blank" class="custom-link">Tweet this book</a>
            </li>
        
        

        
        <li class="divider"></li>
        

        
    
        <li class="chapter " data-level="0" data-path="index.html">
            
                
                    <a href="./index.html">
                        <i class="fa fa-check"></i>
                        
                        序言
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="1" data-path="swiftui-basics.html">
            
                
                    <a href="./swiftui-basics.html">
                        <i class="fa fa-check"></i>
                        
                            <b>1.</b>
                        
                        SwiftUI 介绍
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="2" data-path="swiftui-text.html">
            
                
                    <a href="./swiftui-text.html">
                        <i class="fa fa-check"></i>
                        
                            <b>2.</b>
                        
                        SwiftUI 入门 - 文字的处理
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="3" data-path="swiftui-images.html">
            
                
                    <a href="./swiftui-images.html">
                        <i class="fa fa-check"></i>
                        
                            <b>3.</b>
                        
                        图片的处理
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="4" data-path="swiftui-stacks.html">
            
                
                    <a href="./swiftui-stacks.html">
                        <i class="fa fa-check"></i>
                        
                            <b>4.</b>
                        
                        以堆叠布局使用者介面
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="5" data-path="swiftui-scrollview.html">
            
                
                    <a href="./swiftui-scrollview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>5.</b>
                        
                        ScrollView 与 Carousel UI 的建立
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="6" data-path="swiftui-buttons.html">
            
                
                    <a href="./swiftui-buttons.html">
                        <i class="fa fa-check"></i>
                        
                            <b>6.</b>
                        
                        SwiftUI 按钮与渐层
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="7" data-path="swiftui-state.html">
            
                
                    <a href="./swiftui-state.html">
                        <i class="fa fa-check"></i>
                        
                            <b>7.</b>
                        
                        状态(State)与绑定(Binding)
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="8" data-path="swiftui-path-shape.html">
            
                
                    <a href="./swiftui-path-shape.html">
                        <i class="fa fa-check"></i>
                        
                            <b>8.</b>
                        
                        实现路径(Path)与形状(Shape)来画线与圆饼图
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="9" data-path="swiftui-animation.html">
            
                
                    <a href="./swiftui-animation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>9.</b>
                        
                        基础动画与转场
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="10" data-path="swiftui-list.html">
            
                
                    <a href="./swiftui-list.html">
                        <i class="fa fa-check"></i>
                        
                            <b>10.</b>
                        
                        动态列表、 ForEach 与 Identifiable 的使用方法
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="11" data-path="swiftui-navigation.html">
            
                
                    <a href="./swiftui-navigation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>11.</b>
                        
                        导航UI与导航列客制化运用
                    </a>
                
            
            
        </li>
    
        <li class="chapter active" data-level="12" data-path="swiftui-modal.html">
            
                
                    <a href="./swiftui-modal.html">
                        <i class="fa fa-check"></i>
                        
                            <b>12.</b>
                        
                        强制回应视图、浮动按钮与提示的实现
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="13" data-path="swiftui-form.html">
            
                
                    <a href="./swiftui-form.html">
                        <i class="fa fa-check"></i>
                        
                            <b>13.</b>
                        
                        以选取器(Picker)、开关(Toggle)与步进器(Stepper)来建立一个表单
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="14" data-path="swiftui-form-data.html">
            
                
                    <a href="./swiftui-form-data.html">
                        <i class="fa fa-check"></i>
                        
                            <b>14.</b>
                        
                        使用 Combine 与 Environment 物件进行资料分享
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="15" data-path="swiftui-form-registration.html">
            
                
                    <a href="./swiftui-form-registration.html">
                        <i class="fa fa-check"></i>
                        
                            <b>15.</b>
                        
                        以 Combine 与 视图模型建立一个注册表单
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="16" data-path="swiftui-actionsheet-context.html">
            
                
                    <a href="./swiftui-actionsheet-context.html">
                        <i class="fa fa-check"></i>
                        
                            <b>16.</b>
                        
                        滑动删除、内容选单与动作列表
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="17" data-path="swiftui-gestures.html">
            
                
                    <a href="./swiftui-gestures.html">
                        <i class="fa fa-check"></i>
                        
                            <b>17.</b>
                        
                        认识手势（Gestures）
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="18" data-path="swiftui-bottom-sheet.html">
            
                
                    <a href="./swiftui-bottom-sheet.html">
                        <i class="fa fa-check"></i>
                        
                            <b>18.</b>
                        
                        以SwiftUI 手势与 GeometryReader 建立一个底部展开式页面
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="19" data-path="swiftui-trip-tinder.html">
            
                
                    <a href="./swiftui-trip-tinder.html">
                        <i class="fa fa-check"></i>
                        
                            <b>19.</b>
                        
                        使用手势与动画建立 Tinder 风格的 UI
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="20" data-path="swiftui-advanced-animations.html">
            
                
                    <a href="./swiftui-advanced-animations.html">
                        <i class="fa fa-check"></i>
                        
                            <b>20.</b>
                        
                        建立像 Apple Wallet App 的动画和转场效果
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="21" data-path="swiftui-json.html">
            
                
                    <a href="./swiftui-json.html">
                        <i class="fa fa-check"></i>
                        
                            <b>21.</b>
                        
                        JSON、滑杆的运用与资料过滤
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="22" data-path="swiftui-core-data.html">
            
                
                    <a href="./swiftui-core-data.html">
                        <i class="fa fa-check"></i>
                        
                            <b>22.</b>
                        
                        如何使用 Core Data 建立 ToDo App
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="23" data-path="swiftui-uikit.html">
            
                
                    <a href="./swiftui-uikit.html">
                        <i class="fa fa-check"></i>
                        
                            <b>23.</b>
                        
                        利用 UIViewRepresentable 整合UIKit 组件
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="24" data-path="swiftui-searchbar.html">
            
                
                    <a href="./swiftui-searchbar.html">
                        <i class="fa fa-check"></i>
                        
                            <b>24.</b>
                        
                        建立搜寻栏视图并使用自订绑定（Custom Binding）
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="25" data-path="swiftui-real-world-app.html">
            
                
                    <a href="./swiftui-real-world-app.html">
                        <i class="fa fa-check"></i>
                        
                            <b>25.</b>
                        
                        把所学应用出来！构建个人理财App
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="26" data-path="swiftui-appstoreanimation.html">
            
                
                    <a href="./swiftui-appstoreanimation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>26.</b>
                        
                        创建类似App Store使用的动画视图转换
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="27" data-path="swiftui-carousel.html">
            
                
                    <a href="./swiftui-carousel.html">
                        <i class="fa fa-check"></i>
                        
                            <b>27.</b>
                        
                        如何建立图像轮播（Image Carousel）
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="28" data-path="swiftui-expandable-list.html">
            
                
                    <a href="./swiftui-expandable-list.html">
                        <i class="fa fa-check"></i>
                        
                            <b>28.</b>
                        
                        如何建立展开式列表视图和大纲视图
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="29" data-path="swiftui-gridlayout.html">
            
                
                    <a href="./swiftui-gridlayout.html">
                        <i class="fa fa-check"></i>
                        
                            <b>29.</b>
                        
                        使用 LazyVGrid 和 LazyHGrid 构建集合视图
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="30" data-path="swiftui-progress-ring.html">
            
                
                    <a href="./swiftui-progress-ring.html">
                        <i class="fa fa-check"></i>
                        
                            <b>30.</b>
                        
                        使用 Shape 和 Animatable 开发带动画的环形进度条
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="31" data-path="swiftui-library.html">
            
                
                    <a href="./swiftui-library.html">
                        <i class="fa fa-check"></i>
                        
                            <b>31.</b>
                        
                        如何使用 AnimatableModifier 和 LibraryContentProvider
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="32" data-path="swiftui-texteditor.html">
            
                
                    <a href="./swiftui-texteditor.html">
                        <i class="fa fa-check"></i>
                        
                            <b>32.</b>
                        
                        使用 TextEditor 支持多行文字输入
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="33" data-path="swiftui-matchedgeometry.html">
            
                
                    <a href="./swiftui-matchedgeometry.html">
                        <i class="fa fa-check"></i>
                        
                            <b>33.</b>
                        
                        使用 matchedGeometryEffect为 App 建立绚丽的视图动画
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="34" data-path="swiftui-grid-animation.html">
            
                
                    <a href="./swiftui-grid-animation.html">
                        <i class="fa fa-check"></i>
                        
                            <b>34.</b>
                        
                        ScrollViewReader 和网格动画
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="35" data-path="swiftui-tabview.html">
            
                
                    <a href="./swiftui-tabview.html">
                        <i class="fa fa-check"></i>
                        
                            <b>35.</b>
                        
                        标签视图的运用与自订标签列
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="36" data-path="swiftui-asyncimage.html">
            
                
                    <a href="./swiftui-asyncimage.html">
                        <i class="fa fa-check"></i>
                        
                            <b>36.</b>
                        
                        利用 AsyncImage 非同步加载和显示图像
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="37" data-path="swiftui-searchable.html">
            
                
                    <a href="./swiftui-searchable.html">
                        <i class="fa fa-check"></i>
                        
                            <b>37.</b>
                        
                        利用 Searchable 建立搜寻栏
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="38" data-path="swiftui-charts.html">
            
                
                    <a href="./swiftui-charts.html">
                        <i class="fa fa-check"></i>
                        
                            <b>38.</b>
                        
                        利用 Charts 框架建立图表
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="39" data-path="swiftui-live-text.html">
            
                
                    <a href="./swiftui-live-text.html">
                        <i class="fa fa-check"></i>
                        
                            <b>39.</b>
                        
                        利用 Live Text API 从图片中撷取文本
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="40" data-path="swiftui-sharelink.html">
            
                
                    <a href="./swiftui-sharelink.html">
                        <i class="fa fa-check"></i>
                        
                            <b>40.</b>
                        
                        通过 ShareLink 来分享文本和图像等资料
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="41" data-path="swiftui-imagerenderer.html">
            
                
                    <a href="./swiftui-imagerenderer.html">
                        <i class="fa fa-check"></i>
                        
                            <b>41.</b>
                        
                        利用 ImageRenderer API 轻松把 SwiftUI 视图转换为图像
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="42" data-path="swiftui-pdf-doc.html">
            
                
                    <a href="./swiftui-pdf-doc.html">
                        <i class="fa fa-check"></i>
                        
                            <b>42.</b>
                        
                        如何把 SwiftUI 视图转换为 PDF 文件
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="43" data-path="swiftui-gauge.html">
            
                
                    <a href="./swiftui-gauge.html">
                        <i class="fa fa-check"></i>
                        
                            <b>43.</b>
                        
                        使用 Gauge 视图显示进度并创建速度计
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="44" data-path="swiftui-grid.html">
            
                
                    <a href="./swiftui-grid.html">
                        <i class="fa fa-check"></i>
                        
                            <b>44.</b>
                        
                        使用Grid API 创建网格布局
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="45" data-path="swiftui-anylayout.html">
            
                
                    <a href="./swiftui-anylayout.html">
                        <i class="fa fa-check"></i>
                        
                            <b>45.</b>
                        
                        利用 AnyLayout 切换 UI 布局
                    </a>
                
            
            
        </li>
    
        <li class="chapter " data-level="46" data-path="swiftui-navigationstack.html">
            
                
                    <a href="./swiftui-navigationstack.html">
                        <i class="fa fa-check"></i>
                        
                            <b>46.</b>
                        
                        使用新的 NavigationStack 视图构建资料导向的导航
                    </a>
                
            
            
        </li>
    


        
        <li class="divider"></li>
        <li>
            <a href="https://www.gitbook.com" target="blank" class="gitbook-link">
                本书使用 GitBook 释出
            </a>
        </li>
        
    </ul>
</div>

    <div class="book-body">
        <div class="body-inner">
            <div class="book-header">
    <!-- Actions Left -->
    <a href="#" class="btn pull-left toggle-summary" aria-label="目录"><i class="fa fa-align-justify"></i></a>
    <a href="#" class="btn pull-left toggle-search" aria-label="搜寻"><i class="fa fa-search"></i></a>
    
    <div id="font-settings-wrapper" class="dropdown pull-left">
        <a href="#" class="btn toggle-dropdown" aria-label="字型设定"><i class="fa fa-font"></i>
        </a>
        <div class="dropdown-menu font-settings">
    <div class="dropdown-caret">
        <span class="caret-outer"></span>
        <span class="caret-inner"></span>
    </div>

    <div class="buttons">
        <button type="button" id="reduce-font-size" class="button size-2">A</button>
        <button type="button" id="enlarge-font-size" class="button size-2">A</button>
    </div>

    <div class="buttons font-family-list">
        <button type="button" data-font="0" class="button">衬线体</button>
        <button type="button" data-font="1" class="button">无衬线体</button>
    </div>

    <div class="buttons color-theme-list">
        <button type="button" id="color-theme-preview-0" class="button size-3" data-theme="0">白色</button>
        <button type="button" id="color-theme-preview-1" class="button size-3" data-theme="1">棕褐色</button>
        <button type="button" id="color-theme-preview-2" class="button size-3" data-theme="2">夜间</button>
    </div>
</div>

    </div>

    <!-- Actions Right -->
    
    <div class="dropdown pull-right">
        <a href="#" class="btn toggle-dropdown" aria-label="分享"><i class="fa fa-share-alt"></i>
        </a>
        <div class="dropdown-menu font-settings dropdown-left">
            <div class="dropdown-caret">
                <span class="caret-outer"></span>
                <span class="caret-inner"></span>
            </div>
            <div class="buttons">
                <button type="button" data-sharing="twitter" class="button">
                    分享到 Twitter
                </button>
                <button type="button" data-sharing="google-plus" class="button">
                    分享到 Google
                </button>
                <button type="button" data-sharing="facebook" class="button">
                    分享到 Facebook
                </button>
                <button type="button" data-sharing="weibo" class="button">
                    分享到 Weibo
                </button>
                <button type="button" data-sharing="instapaper" class="button">
                    分享到 Instapaper
                </button>
            </div>
        </div>
    </div>
    

    
    
    
    

    <!-- Title -->
    <h1>
        <i class="fa fa-circle-o-notch fa-spin"></i>
        <a href="./" >精通 SwiftUI - iOS 16 版</a>
    </h1>
</div>

            <div class="page-wrapper" tabindex="-1">
                <div class="page-inner">
                
                
                    <section class="normal" id="section-">
                    
                        <h1 id="%E7%AC%AC-12-%E7%AB%A0-br-%E5%AF%A6%E4%BD%9C%E5%BC%B7%E5%88%B6%E5%9B%9E%E6%87%89%E8%A6%96%E5%9C%96%E3%80%81%E6%B5%AE%E5%8B%95%E6%8C%89%E9%88%95%E8%88%87%E8%AD%A6%E5%91%8A%E6%8F%90%E7%A4%BA%E8%A6%96%E7%AA%97">第 12 章<br>实现强制回应视图、浮动按钮与警告提示视窗</h1>
<p>在前一章中，我们建立了一个导航介面，让使用者从内容视图导航至细节视图。视图转场动画很精巧，并且完全由iOS 负责。当使用者触发转场时，细节视图会流畅地从右至左滑动。导航 UI 只是常用的 UI 模式之一，在本章中，我将向你介绍另一个强制显示内容的设计技巧。</p>
<p>对于 iPhone 的使用者，你应该非常熟悉强制回应视图了。强制回应视图的一种常见用途是显示输入表单，例如：行事历 App 为使用者显示一个强制回应视图来建立一个新事件。系统内建的提醒事项与联络人 App 也使用强制回应视图来要求使用者输入。</p>
<figure id="fig12.1"><img src="images/modal/swiftui-modal-1.png" alt="图 12.1.　行事历、提醒事项与联络人 App 的强制回应视图示例"><figcaption>图 12.1.　行事历、提醒事项与联络人 App 的强制回应视图示例</figcaption></figure>
<p>从使用者体验的角度来看，这个强制回应视图通常是通过点击按钮来触发。同样的， 强制回应视图的转场动画是由 iOS 所处理。当显示全荧幕的强制回应视图时，它会流畅地从画面底部向上滑动。</p>
<p>如果你是 iOS 的长期使用者，你可能会发现如图 12.1 所示的强制回应视图的外观及感觉和平常不太一样。在 iOS 13 之前，显示强制回应视图时会覆盖整个画面，自 iOS 13 起，强制回应视图默认是以卡片式的形式显示，其不会覆盖全画面，而是部分覆盖了底层内容视图，你仍然可看到内容 / 父视图的顶部边缘。除了视觉变动之外，现在可从画面的任意位置向下滑动来解除强制回应视图。你不需要撰写任何一行代码，即可启动这个手势。它完全是内建且由 iOS 产生。当然，若是你想通过按钮来解除强制回应视图，则依然可以这样做。</p>
<p>那么，我们将在本章中要实现什么呢？ </p>
<p>我教你如何使用强制回应视图显示和在前一章中我们实现过的相同细节视图，虽然强制回应视图通常用于显示表单，这并不表示你不能使用它们来显示其他资讯。除了强制回应视图之外，你还将学习如何在细节视图中建立浮动按钮。虽然可通过滑动手势来解除强制回应视图，但我想提供一个“Close”按钮来供使用者解除细节视图。另外，我们也将研究警告提示视窗（Alert ），这是另一种强制回应视图。</p>
<figure id="fig12.2"><img src="images/modal/swiftui-modal-2.jpg" alt="图 12.2.　使用强制回应视图来显示细节画面"><figcaption>图 12.2.　使用强制回应视图来显示细节画面</figcaption></figure>
<p>我们在本章中有许多要讨论的内容。让我们开始吧 ！ </p>
<h3 id="%E4%BA%86%E8%A7%A3-swiftui-%E7%9A%84%E5%B7%A5%E4%BD%9C%E8%A1%A8">了解 SwiftUI 的工作表</h3>
<blockquote>
<p>工作表（sheet ）的表现风格看起来为一张卡片，其部分覆盖了底层内容，并使所有未覆盖到的地方变暗，以防止与其互动。在目前卡片的后面可看见父视图或上一张卡片的顶部边缘，以帮助人们记住他们开启卡片时暂停的任务</p>
<p>- Apple 的官方文件(<a href="https://developer.apple.com/design/human-interface-guidelines/ios/app-architecture/modality/" target="_blank">https://developer.apple.com/design/human-interface-guidelines/ios/app-architecture/modality/</a>)</p>
</blockquote>
<p>在深入钻研如何实现之前，让我先简要介绍一下强制回应视图的卡片式外观。在 SwiftUI 中，卡片外观是使用工作表的表现风格来实现，这是强制回应视图的默认表示风格。</p>
<p>基本上，要显示强制回应视图，你可应用 <code>sheet</code> 修饰器，如下所示： </p>
<pre><code class="lang-swift">.sheet(isPresented: $showModal) {
    <span class="hljs-type">DetailView</span>()
}
</code></pre>
<p>它采用布林值来指示是否显示强制回应视图，如果 <code>isPresented</code> 设定为 <code>true</code>，则强制回应视图将自动以卡片形式显示。</p>
<p>显示强制回应视图的另一种方式，可以写成如下代码： </p>
<pre><code class="lang-swift">.sheet(item: $itemToDisplay) {
    <span class="hljs-type">DetailView</span>()
}
</code></pre>
<p><code>sheet</code> 修饰器也让你可通过传送一个 <code>Optional</code> 绑定来触发强制回应视图的显示。如果 <code>Optional</code>有一个值，iOS 会带出强制回应视图，如果你还记得我们在前一章中对于 <code>actionSheet</code> 的讨论，你应该会发现 <code>sheet</code> 的用法与 <code>actionSheet</code> 非常相似。</p>
<h3 id="%E6%BA%96%E5%82%99%E8%B5%B7%E5%A7%8B%E5%B0%88%E6%A1%88">准备起始项目</h3>
<p>以上是背景资讯，我们来继续实际执行示例项目。首先，，请至
<a href="https://www.appcoda.com/resources/swiftui4/SwiftUIModalStarter.zip" target="_blank">https://www.appcoda.com/resources/swiftui4/SwiftUIModalStarter.zip</a>。 下载起始项目，下载后开启项目，并看一下预览，如图 12.3 所示。你应该非常熟悉示例 App 了，该 App 仍有一个导航列，但导航连结已被删除。</p>
<figure id="fig12.3"><img src="images/modal/swiftui-modal-3.png" alt="图 12.3.　起始项目"><figcaption>图 12.3.　起始项目</figcaption></figure>
<h3 id="%E4%BD%BF%E7%94%A8-ispresented-%E5%AF%A6%E4%BD%9C%E5%BC%B7%E5%88%B6%E5%9B%9E%E6%87%89%E8%A6%96%E5%9C%96">使用 isPresented 实现强制回应视图</h3>
<p>如前所述，<code>sheet</code> 修饰器提供我们两种显示模式的方式。我将展示这两种方法如何工作，我们从 <code>isPresented</code> 方法开始，对于这个方法，我们需要一个Bool 型别的状态变量来追踪强制回应视图的状态。在 <code>ContentView</code>中声明这个变量：</p>
<pre><code class="lang-swift">@<span class="hljs-type">State</span> <span class="hljs-keyword">var</span> showDetailView = <span class="hljs-built_in">false</span>
</code></pre>
<p>默认情况下，它设定为 <code>false</code>。当点击其中一列时，该变量的值将会设定为 <code>true</code>。稍后， 我们会在代码中做这个变更。</p>
<p>当显示细节视图时，该视图需要我们传送所选的文章，因此我们也需要声明一个状态来储存使用者的选择。在<code>ContentView</code> 中，为此声明另一个状态变量如下： </p>
<pre><code class="lang-swift">@<span class="hljs-type">State</span> <span class="hljs-keyword">var</span> selectedArticle: <span class="hljs-type">Article</span>?
</code></pre>
<p>为了实现强制回应视图，我们将 <code>sheet</code> 修饰器加到 <code>List</code> 上，如下所示：</p>
<pre><code class="lang-swift"><span class="hljs-type">NavigationStack</span> {
    <span class="hljs-type">List</span>(articles) { article <span class="hljs-keyword">in</span>
        <span class="hljs-type">ArticleRow</span>(article: article)

        .listRowSeparator(.hidden)
    }
    .listStyle(.plain)
    .sheet(isPresented: $showDetailView) {

        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> selectedArticle = <span class="hljs-keyword">self</span>.selectedArticle {
            <span class="hljs-type">ArticleDetailView</span>(article: selectedArticle)
        }
    }

    .navigationTitle(<span class="hljs-string">&quot;Your Reading&quot;</span>)
}
</code></pre>
<p>强制回应视图的显示取决于 <code>showDetailView</code> 属性的值，这就是为何我们在 <code>isPresented</code> 参数中指定它的原因。该 <code>sheet</code> 修饰器的闭包声明要显示的视图布局。这里我们将显示 <code>ArticleDetailView</code>。</p>
<p>最后一个问题是我们如何侦测触控呢？当建立导航UI 时，我们利用 <code>NavigationLink</code> 来处理触控， 然而此特殊按钮是为导航介面所设计。在 SwiftUI 中， 有一个名为 <code>onTapGesture</code> 的处理器，可以用来识别触控手势，因此你可以将此处理器加到每个 <code>ArticleRow</code> 来侦测使用者的触控。现在修改 <code>body</code> 变量中的 <code>NavigationStack</code>，如下所示： </p>
<pre><code class="lang-swift"><span class="hljs-type">NavigationStack</span> {
    <span class="hljs-type">List</span>(articles) { article <span class="hljs-keyword">in</span>
        <span class="hljs-type">ArticleRow</span>(article: article)
            .onTapGesture {
                <span class="hljs-keyword">self</span>.showDetailView = <span class="hljs-built_in">true</span>
                <span class="hljs-keyword">self</span>.selectedArticle = article
            }

        .listRowSeparator(.hidden)
    }
    .listStyle(.plain)
    .sheet(isPresented: $showDetailView) {

        <span class="hljs-keyword">if</span> <span class="hljs-keyword">let</span> selectedArticle = <span class="hljs-keyword">self</span>.selectedArticle {
            <span class="hljs-type">ArticleDetailView</span>(article: selectedArticle)
        }
    }

    .navigationTitle(<span class="hljs-string">&quot;Your Reading&quot;</span>)
}
</code></pre>
<p>在 <code>onTapGesture</code> 的闭包中，我们将 <code>showDetailView</code> 设定为 <code>true</code>，这是用于触发强制回应视图的显示。我们也将所选的文章储存在 <code>selectedArticle</code> 变量中。</p>
<p>现在于预览画布上执行这个 App。你应该能够以强制回应模式带出细节视图，如图 12.4 所示。</p>
<p><em>注意：当你第一次打开模态视图时，它显示的是一个空白视图。 擦拭对话框以关闭它，然后选择另一篇文章（不是同一篇文章），App应该会显示正确的文章。 这是一个已知问题，我们将在后面的部分讨论如何改善。</em></p>
<figure id="fig12.4"><img src="images/modal/swiftui-modal-4.png" alt="图 12.4. 以强制回应模式来显示细节视图"><figcaption>图 12.4. 以强制回应模式来显示细节视图</figcaption></figure>
<h3 id="%E4%BD%BF%E7%94%A8-optional-%E7%B6%81%E5%AE%9A%E5%AF%A6%E4%BD%9C%E5%BC%B7%E5%88%B6%E5%9B%9E%E6%87%89%E8%A6%96%E5%9C%96">使用 Optional 绑定实现强制回应视图</h3>
<p><code>sheet</code> 修饰器还提供另一种显示强制回应视图的方式。这里不使用布林值来控制强制回应视图的外观，这个修饰器让你使用一个 Optional 绑定来实现相同的目标。</p>
<p>你可以将 <code>sheet</code> 修饰器替换为下列代码： </p>
<pre><code class="lang-swift">.sheet(item: $selectedArticle) { article <span class="hljs-keyword">in</span>
    <span class="hljs-type">ArticleDetailView</span>(article: article)
}
</code></pre>
<p>在这种情况下，<code>sheet</code> 修饰器需要你传送一个 Optional 绑定。这里我们指定为 <code>selectedArticle</code> 绑定，这表示只有当所选的文章有值，iOS 才会带出强制回应视图。闭包中的代码指定强制回应视图的外观，但它和我们之前所撰写的有些不同。</p>
<p>对于这个方法，<code>sheet</code> 修饰器将闭包中所选的文章传送给我们。article 参数包含了所选的文章，且该文章确保有一个值，这就是为何我们可以使用它来初始化 <code>ArticleDetailView</code>。</p>
<p>由于我们不再使用 <code>showDetailView</code> 变量，因此你可以删除下列这行代码： </p>
<pre><code class="lang-swift">@<span class="hljs-type">State</span> <span class="hljs-keyword">var</span> showDetailView = <span class="hljs-built_in">false</span>
</code></pre>
<p>另外，从 <code>.onTapGesture</code> 闭包中删除 <code>self.showDetailView = true</code>:</p>
<pre><code class="lang-swift">.onTapGesture {
    <span class="hljs-keyword">self</span>.showDetailView = <span class="hljs-built_in">true</span>
    ...
}
</code></pre>
<p>更改代码，你可以再次测试这个App。运作一如往常，但底层比原来更简洁。</p>
<h3 id="%E5%BB%BA%E7%AB%8B%E6%B5%AE%E5%8B%95%E6%8C%89%E9%88%95%E4%BE%86%E8%A7%A3%E9%99%A4%E5%BC%B7%E5%88%B6%E5%9B%9E%E6%87%89%E8%A6%96%E5%9C%96">建立浮动按钮来解除强制回应视图</h3>
<p>强制回应视图具有向下滑动手势的内建支持。现在，你可以向下滑动视图来关闭它，我想这对于 iPhone 长期使用者而言很自然，因为如 Facebook 之类的 App 已使用这个手势来解除视图，但是新的使用者可能对此一无所知，我们最好开发一个“关闭”按钮作为解除强制回应视图的替代方式。</p>
<figure id="fig12.5"><img src="images/modal/swiftui-modal-7.png" alt="图 12.5. 浮动按钮"><figcaption>图 12.5. 浮动按钮</figcaption></figure>
<p>现在切换到 <code>ArticleDetailView.swift</code>， 我们将“关闭”按钮加入至视图中，如图 12.5  所示。</p>
<p>你知道如何将按钮放在右上角吗？试着不直接遵循我的代码，而是提出自己的实现。</p>
<p>好的，回到实现部分。</p>
<p>和 <code>NavigationStack</code> 类似，我们可以使用 <code>dismiss</code> 环境值来解除模式。因此，首先在<code>ArticleDetailView</code> 中声明下列的变量： </p>
<pre><code class="lang-swift">@<span class="hljs-type">Environment</span>(\.dismiss) <span class="hljs-keyword">var</span> dismiss
</code></pre>
<p>对于“关闭”按钮，我们可以将 <code>overlay</code> 修饰器加到滚动视图上（在<code>ignoresSafeArea</code>之前添加），如下所示： </p>
<pre><code class="lang-swift">.overlay(

    <span class="hljs-type">HStack</span> {
        <span class="hljs-type">Spacer</span>()

        <span class="hljs-type">VStack</span> {
            <span class="hljs-type">Button</span> {
                dismiss()
            } label: {
                <span class="hljs-type">Image</span>(systemName: <span class="hljs-string">&quot;chevron.down.circle.fill&quot;</span>)
                    .font(.largeTitle)
                    .foregroundColor(.white)
            }

            .padding(.trailing, <span class="hljs-number">20</span>)
            .padding(.top, <span class="hljs-number">40</span>)

            <span class="hljs-type">Spacer</span>()
        }
    }
)
</code></pre>
<p>如此，按钮将会覆盖在滚动视图上方，以浮动按钮的形式显示。即使你向下滚动视图，按钮也会停留在相同的位置。要将按钮放在右上角，这里我们使用 <code>HStack</code> 与 <code>VStack</code>， 然后加上 <code>Spacer</code> 作为辅助。要解除视图， 你可以调用  <code>dismiss()</code> 函数。</p>
<figure id="fig12.6"><img src="images/modal/swiftui-modal-8.png" alt="图 12.9. 实现“关闭”按钮"><figcaption>图 12.9. 实现“关闭”按钮</figcaption></figure>
<p>现在于模拟器中实现 App，或切换至 <code>ContentView</code>，并在画布中执行。你应该能点选“关闭”按钮来解除强制回应视图。</p>
<h3 id="%E4%BD%BF%E7%94%A8%E8%AD%A6%E5%91%8A%E6%8F%90%E7%A4%BA%E8%A6%96%E7%AA%97">使用警告提示视窗</h3>
<p>除了卡片式的强制回应视图，“警告提示视窗”（ Alert ）是另一种强制回应视图，当它显示时，整个画面会被锁住，如果你不选择其中一个选项，将会无法离开。图 12.7 为一个警告提示视窗的示例，这是我们将在示例项目中实现的内容，而我们所要做的是，当使用者点击“关闭”按钮后，显示一个警告提示视窗。</p>
<figure id="fig12.7"><img src="images/modal/swiftui-modal-9.png" alt="图 12.7　显示一个警告提示视窗"><figcaption>图 12.7　显示一个警告提示视窗</figcaption></figure>
<p>在 SwiftUI 中，你可以使用 <code>Alert</code> 结构来建立一个警告提示视窗，下列是 <code>Alert</code> 的示例用法： </p>
<pre><code class="lang-swift">.alert(<span class="hljs-string">&quot;Warning&quot;</span>, isPresented: $showAlert, actions: {
    <span class="hljs-type">Button</span> {
        dismiss()
    } label: {
        <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;Confirm&quot;</span>)
    }

    <span class="hljs-type">Button</span>(role: .cancel, action: {}) {
        <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;Cancel&quot;</span>)
    }
}, message: {
    <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;Are you sure you want to leave?&quot;</span>)
})
</code></pre>
<p>示例代码初始化一个标题为“警告”的警告提示视图，警告提示视窗还向使用者显示“你确定要离开吗”。在警告提示视图中有两个按钮：“确认”（Confirm ）与“取消”（Cancel ）。</p>
<p>要建立如图 12.7 的警告提示视窗，代码如下所示： </p>
<pre><code class="lang-swift">.alert(<span class="hljs-string">&quot;Reminder&quot;</span>, isPresented: $showAlert, actions: {
    <span class="hljs-type">Button</span> {
        dismiss()
    } label: {
        <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;Yes&quot;</span>)
    }

    <span class="hljs-type">Button</span>(role: .cancel, action: {}) {
        <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;No&quot;</span>)
    }

}, message: {
    <span class="hljs-type">Text</span>(<span class="hljs-string">&quot;Are you sure you are finished reading the article?&quot;</span>)
})
</code></pre>
<p>除了主按钮具有 <code>action</code> 参数之外，它和先前的代码类似。这个警告提示视窗询问使用者是否已阅读完文章，若是使用者选择“是”（ Yes ），它会继续关掉强制回应视图，否则强制回应视图将保持开启。</p>
<p>现在，我们已有了建立警告提示视窗的代码，问题是如何触发警告提示视窗的显示呢？ SwiftUI 提供一个可加到任何视图的 <code>alert</code> 修饰器。同样的，你使用一个布林变量来控制警告提示视窗的显示，因此在 <code>ArticleDetailView</code>中声明一个状态变量： </p>
<pre><code class="lang-swift">@<span class="hljs-type">State</span> private <span class="hljs-keyword">var</span> showAlert = <span class="hljs-built_in">false</span>
</code></pre>
<p>接下来，将以上的 <code>alert</code> 修饰器加到 <code>ScrollView</code> 上。 </p>
<p>还剩下一件事，我们应该何时触发警告提示视窗呢？换句话说，我们何时要将 <code>showAlert</code> 设定为 <code>true</code> ？ </p>
<p>显然的，当某人点击“关闭”按钮时，App 应该显示警告提示视窗。因此，替换按钮动作的代码如下： </p>
<pre><code class="lang-swift"><span class="hljs-type">Button</span> {
    <span class="hljs-keyword">self</span>.showAlert = <span class="hljs-built_in">true</span>
} label: {
    <span class="hljs-type">Image</span>(systemName: <span class="hljs-string">&quot;chevron.down.circle.fill&quot;</span>)
        .font(.largeTitle)
        .foregroundColor(.white)
}
</code></pre>
<p>我们没有直接解除强制回应视图，而是通过将 <code>showAlert</code> 设定为 <code>true</code>，来指示 iOS 显示警告提示视窗。现在你可以测试 App 了，当你点击“关闭”按钮时，你将看到警告提示视窗，如图12.10 所示。若是你选择“是”（Yes ），强制回应视图将解除。</p>
<figure id="fig12.8"><img src="images/modal/swiftui-modal-10.png" alt="图 12.8.　点击“关闭”按钮将显示警告提示视窗"><figcaption>图 12.8.　点击“关闭”按钮将显示警告提示视窗</figcaption></figure>
<h3 id="%E5%85%A8%E8%9E%A2%E5%B9%95%E5%BC%B7%E5%88%B6%E5%9B%9E%E6%87%89%E8%A6%96%E5%9C%96%E7%9A%84%E5%91%88%E7%8F%BE">全荧幕强制回应视图的呈现</h3>
<p>自从 iOS 13 开始，强制回应视图默认是不使用全荧幕的覆盖形式。如果想要以全荧幕来呈现强制回应视图的话，你可以使用 iOS 14 所导入的 <code>.fullScreenCover</code> 修饰器，替代 <code>.sheet</code> 修饰器来呈现强制回应视图， <code>.fullScreenCover</code> 修饰器的用法如下：</p>
<pre><code class="lang-swift">.fullScreenCover(item: $selectedArticle) { article <span class="hljs-keyword">in</span>
    <span class="hljs-type">ArticleDetailView</span>(article: article)
}
</code></pre>
<h3 id="%E6%9C%AC%E7%AB%A0%E5%B0%8F%E7%B5%90">本章小结</h3>
<p>你已经学习了如何显示强制回应视图、实现浮动按钮以及显示警告提示视窗。iOS 持续鼓励使用者利用手势来与装置互动，并为常见手势提供内建支持。不需要撰写一行代码，即可让使用者在画面上向下滑动，以解除强制回应视图。</p>
<p>强制回应视图与警告提示视窗的 API 设计非常相似，它监控状态变量，以确认是否触发强制回应视图（或警告提示视窗）。一旦你了解这个技术后，实现对你而言应该不困难了。</p>
<p>在本章所准备的示例档中，有完整的项目可供下载： </p>
<ul>
<li>示例项目 (<a href="https://www.appcoda.com/resources/swiftui4/SwiftUIModal.zip" target="_blank">https://www.appcoda.com/resources/swiftui4/SwiftUIModal.zip</a>)</li>
</ul>

                    
                    </section>
                
                
                </div>
            </div>
        </div>

        
        <a href="./swiftui-navigation.html" class="navigation navigation-prev " aria-label="Previous page: 导航UI与导航列客制化运用"><i class="fa fa-angle-left"></i></a>
        
        
        <a href="./swiftui-form.html" class="navigation navigation-next " aria-label="Next page: 以选取器(Picker)、开关(Toggle)与步进器(Stepper)来建立一个表单"><i class="fa fa-angle-right"></i></a>
        
    </div>
</div>

        
<script src="gitbook/app.js"></script>

<script>
require(["gitbook"], function(gitbook) {
    var config = {"fontSettings":{"theme":"white","family":"serif","size":3},"image-captions":{"caption":"_CAPTION_","variable_name":"_pictures"}};
    gitbook.start(config);
});
</script>

        
    </body>
    
</html>
